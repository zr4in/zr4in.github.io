<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>一些碎碎念</title>
    <link href="/2025/05/25/%E4%B8%80%E4%BA%9B%E7%A2%8E%E7%A2%8E%E5%BF%B5/"/>
    <url>/2025/05/25/%E4%B8%80%E4%BA%9B%E7%A2%8E%E7%A2%8E%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="哈希校验错误">  <script id="hbeData" type="hbeData" data-hmacdigest="0cfa8cf16f28cd6954bcccd93a7b3ef7742e5360dd1468d71342464c189cf6ad">e90fdfb987089724edd03e42260cea5766ee4438c4090a205c8b180301c16c91385a41dbfa819ef44f7c5fa4d8be1ca24fb20c7fa1205d26e43e998d19a335bcfdd2079b21468b6c113a1ed33e9b136089fb5156f20a2cbb3c25bc036ab8dacb624d9e020279f3d086f880bbf5333b46616ee00aa72516cbffea868629a81714413738b57d4b0e181b5e67ced14e1f14ce54a3b3322bb59dcc94426c9f6d8ff8be1d90f07183265102755a21c50c6ee1b8512916ff47cca32fb576e41ff7a82f5aeb4e74551f05bb93e654f56b92759f2488d94728e39e7a58c9136a88bc580f2dd517c9de9c04efab62f91d11f7a9d22c42f40389e7623e1ee0a9f9594b3cc1dd328ef97703c0307344423a14b23a189e1d85a0c7e6633426abcf0e8193debf11019d9e0f9e827fad6d004473b18808a346d97f54e18549fa41c32aa25286fa39d388873bd9f9c9e3e02c300a79d1c2b4999a4def65defdbb8320e4aade0062b43c154874b56c2d8bd778b78d08c0fb5fc0ffcac4db8b9ef44e0e9903c4006ec790d38c9a1677376e2330074866f8ef94691b5c5cc062a395f1e569ee5ddd7c6ec1c94e65384609af93b0b870a94224a53d27f90b318a31567167c5c966b5499a5248bf6b2eaddd94632e215ef9c1dbc2ef7826c01cc318aedb2e3a85c71f6609bfc6469a29cf47ec0e9c7d034aca9d353811024d4a37bd426174926e2d59318198c8b7cbfe8e22257c6b959c1e3ee12e5ae411cdd18903aa15b4b1cdf812143e2966efb28302e6c2c719e8d04e6e2e23a460156bc035917cfaf4fa4233bce636e0293d1d101dcb724a81c1c1e2ae601805b246d614b46120c8da3f0001e01172b0fc87b7b89f0d14bee9226442bfb9e84fc9c48d96f0d37daa446c9910ddcd162b03028fcb88b40371d441089ffe287dc0ea157a7620c1fa2b6816a4159aa8ba578128d99ae7f9e6a2b89f942da1265d5b4f40fb63e09abf064c3f6db055c6832dac081d21b7eaf309a8931e2d765f18b71608e24c69a74a6b56b6f9ee6db244a478cb214f5f59d95a40191b3dc07778a362b4fc2bd51d6e766a3055efdca4fc20bb737b83a3626fa1f23d02696cd0812c7ff64b58c95a52da68148568a1062937622aae4ab33fdecf92de0ba37e43f377063c07cd3f756223c3b74db408eb14b90e716e47f9d768fdf8852464173b2654fe4a1edef54999b2a1989c7e3f35c8c288b8d182a7cfa154193513e3d1fb45b12784bd2c095d38e728dff6e11eaf23e61bec7721573ac05e069ec1b00fafac861d671a75c6f7ebd3ad9b97cab45c6ed5aa44bf1355e2b995b7e92389acc0efe359e2c1a4c3b70c88ee8d73d37282c26776e44525065963b91346007e2e9e3904a8df87746307694dc5e05bf36ce1b11f62cab6360dff8329717baa3aa8a3ac33ba22864a27851f0cbc6ffe0ef49409a02053800606e2545ad496c81e4d8535a421767d1fe02e3d0f6b0fb9650c8c7bc5f55df5756ad7d55cc9ed7983c15652df21d7152be16f9a7c9f190129afb39cd2f44799e529fa6ddae580778519933c6f3b1bc5a24cb3d5345a8ba36bb434fdb9e950262d821c79c77d6617ac9b268fb449987c38508ef42e69e2c74f2decc16b17f901727bcbea9c1806656db0a5bebbe72f121feeb8d0334d34b6505dc0db264069d320996cb78964a92b593a5450f20a8f63aeaf5bca8f08b3d997a75b557e8ec5045adbf515a343e2eb4ba77e9e8bd9a23e6910aa8ef883dcd19bae848fb91c5bcdbdfd3eb099d98658e013dbb86f14fb09917d3591a0bde4fe2d3232ecacf5bffd9f7df90a5f654998800141fcd4c1db3fd9319d84c306907a26d3a5e7b9ed6bd378d8aaaec117ba89f2e214243047dd220a9ac1b530b40485995f3191348431d0a98d4b90ef45805680e4b4bcec76f0dd5040180757d58278041672a1160ea10f0b0abda3f8b87441b21921df9fae914c5cbf865a3fad002326db70b5343750c1be990f205b7b3bce231900b77680d008d89ebb01c32b8331e480667949673236aed7d98f28cf8a2c71418137c22d62df99bbe46e09ea47d96ffd917b3a193bc95ec15c433e43e6e27ba12e3a5e0f54fa65ee32a9cc554b595457116f87445cc1667dad8a20b76b7021423dfda689187c5b2896a415372c8028be55e872dfdfc80c7681ac3cf90637567856b439d4508c589129bdabcd60c87d0f744f091ebe41e99bcd58b9c84d68791dd09d37f2d947278f4c56935024fb293c409a080f18a2c1954a2727e0729be6e806e56c897c917127522b2b7ca6d3ec04df4d648f44e1bd938157c253f0984bae074df7fec637840835a033208797e0d34fea70dbea6f63c3a9fe4d2d4af1fab3a1b38fa7f7b8ffc2fddb082545ea4f81a327192b9d6089683990640b6f38eee54d3c5957439c78031873d00ee2cbffeb2e2a0cf5c9a4d223f55a280579074b6e5dc393266d16f16739a280b528662334ac5c7daecaaabd8e44ad22b9407545e855954dd6ec36a467c68244a94e11eb4543eae211745e3bf4a47eb733cdf2dfc31640d8f645a444a1fb5521ab4d7bbed89604d2eb79dd0c6ebc671cb57e739371df3403c4b0db6c56bdbdf3f556504bf735a9e1b421947eb57ce270a19151e598cd192a119b742e60b5cab75a2cbabad86d2cf712e43187db4c861b46e7ef7aa497680cff0d69cf21220aaf1f4f645da91782aca0ba0f4ea82265bbb03fa3bd8ae61c3849f39bbf091545d58b39d169817e859807173eb5d680f06b44031d31c0b2f1e963102783ca2f81edcf3beb5992a8cef631ae71af74207d0515fcc9ce9b1bbb7a74ab4bd9e536d75c578e7a8b5be586a2a2e237b976a066feea0b37a7ec54bc2ecb5014efaa8df8448a3492b8b0096d5cb2e0cdbd596a2410263d60dc6fc2aba0b9e6ae2d47f67adc5aa7b089a2e41e317a44f4d34bd3b8be37b8dd4d824ca92855ca9ad2d5cb3446c2bfacc560e342bf7c118e6f89e765099a67cca6cd3546fee2bf3a84b256053c27313829fac66f399b0637325efdd66b1db1cec534951f0c43256e814bbdbb99bd9fddfe4ab06a3560d084ddf5d4402008c2a72b3ed0e2cc012945de0938c231ee56bb273d856d151b35424ce0f14233b3a0996ce1b880dd4e7d637d4a882859e83265fd6f3bfed1f095ed87845e0526c59a042c025ae52a7cd7859abc6ae1b6dfe56407ccda878001d43e2db01cb5f2044d2a5a3252ae6e9d874d6efc5cf733bab556733f2c8c7de83c1646663c0406167c6cef87e62696097ef65f1a15aed36ca770a480a2194ca690a33624bad7fa94d3d0cab59ae95fe24bdc6c3c9e0d2610e75f85bde51a36188afaaabd526eb15239ee377d578fca7bae66e2212c1dc3ad64b6d9f64fb066f6e549e815b43bab0c3c764b3e4409860cb83c81abafa4b5b423e1201a52d6bb907059d35a41138355d1792f243e805c506ee3e51bf946091442d770a4b2bb331ebd513da6a63e601b27c2fe0bdcdb534620139ebfbc7988564e47b6636b41dbd1885aef22d8ffe6a1fc041509ae3b3ba56b11c331413d577fc39b0353be3d46ed0328d31d7f4dc2d117b1e5f682addcedd9f75fc2a864fb88f10ed8ddeb8013a63b0559f862134e43d51006dc8b1ad7deb0c27f6005f77220f21dbb1a2913416c6aae01a59c6e2f80b6bc6e4c8c93c58c9396ad6e2ea665ecb6bfc2ded9a12a3258250c7aa44d645abe77d5c252c7d23a7330cf8b65ea058479d79dc109479c3fdc31cd286c685e3acd9c04442f2ed85d59f064610689e8ca9ad2f5f5e07a68c2a320eba5fcc9a766f78371cab7be834bdf7ff5d883488880ce826aa4b21b44b66d9f1971591c54ae66b0684617eef7df71d69314fa03344df2f378c552ee634ed50c875e2614acb3b9c34c6879efa2853f1a1288a16a26b2b7403a1c13e8958a180351e0d60b78b92f8b6f3a0c927359d2ce2755c5fa5a825c0142b19b097fbfa949dec805a2d4cfea48f19369d8d00f5077eed4c2bbbae3c286e867c418276b57b60c8c79e57e9325e203019881efed0db89d0c90236487a6398c4eb02a9a4fdadb628348c868c2f87abe4231ec67f6bc994cda102a3397cc516f6d49fdfc06545fb6aaadf5e626a78788043e8425aab6418287885679a98333c7d5a5b7a2b597b1a61c26603133dc5fa8966fcb4f5a77a30a026045fc1f18653f76c61a4b2bf798c8c5552818cc7fcb3c58941d2d8815f5fe3888882c96f1e3a2131667f8f558956c5e6a55a3636131f970878b1eca1df4efdf4c80dfbd61b8ef96128a2cccf5f69b11f0eb1fa4bfd905f8a94c096a3221eadcf560bf06f1367d403c71131b8a3e5bba1873243615e45953e9edae9f3d70bfff1ed1fd43ff48bc58b7e68b34f8bcfae3005fd82c889b2f37ae12fdf2f21100404d83970477e6f4023166d73b5ef6eac592f376acc02897d1061f2f12e6d82a8101f1861952f8fd1bcbe94c23ba8b78c1fa761f9714645fa03acb564eead56dadd04c40648f7f797b2e9a9c0ca8ed8d4c69c5e2fa38c298cafcb0e5e853172bc81f598cd43b08b92fd95d06501297a592358d191aa9d4abb6b2c0753d9f1d82b6966069266b1e40d8b7754ef918526e962cdbed786a7c0c334e2e0093bc67ee939f598ee38af7c23558ca1cf29f15819ad247ba3d76d9d633cffac814f73fef180de46c84aeb1ab39a6c3a9079e6e07b73d90cd7e89357062adcb10e4480ebc7290a37e3f765b175c88000e8bca1a88de7864b6f836d47734322892a0e3f4aa7cc3f3df2d8dc35eaacd63932eeb66792e9cd97a1b1ddc8f17513e44992d9a2f93e12fbbc505eef3945ee6f20d35d15dcce8699bd95bf92547c02d8ae4d72573bb090922631cd3d123b299715dd25eef602c65262c9fea9defc13a23da3532d05898357e3db79fa1733b93b03e08b6ba3391f290e663032f569a067c4f327d38b7c51e288eaa1ed5c7c65a37bcc6af06da2609aa24e7c59536c88e67aa4f0a3fc5f4834a0a5011ee162d8937520688662d7422db0ac2cfcde8fe8be76439fc92fd6447c2ac960ef04ee1f6e48dd51790ff2ea7d1f0abff8e39a87d5eb650791a835c54c68f7cd72bc408d535d96c1262b7f33589883cd435549209887b8c22eba9d80b19a7bbc86e9fcdbf06deeb5d896d83c8abcebc77ce25e377b7af9a3440fbf3db3b52fd4d0e9dff20d92c95f64d8a9cf0b77a4891b910ea352e40224630c997363dd62e1434a988a548b743ea7e7b7a3a30f7afc9c3ba5c131a4a8ec8fc47ba12879c077a1d84eea8ef4ac22ac78d01b848271593526fd1b600dd9ea66214650a8ead6e6c7e84f323d83025c31b08b29892b6541936ace094d22d7405a888a7edc259c831d342e77cf4d5a3b5a56ac36feb87c226a5809797d4b9255c64cf836dbfc88201e84d60c6634d8a03c7682fdaeb444303e75602552574f7f304ec04a1e0dd5ae8761cbd9720828e0c756b10e0dcb262f3d086878383fa42261faea5009c499332ccadcec087a224b0efd0145bd8375cbe70f42134eddd3198c03529b91f3a164b94bea7ce653ef78a4cba70bf45de1666ba8b377fce0c7f457538e13a9296b752cd198c16fa3c069902649db99dd35b0fe9c03f23e52dedcd3c38f36a7970589c9fa86439ce7bf123086f8d3b1ad458572168bfcaee17d887414557f06b830d42f792bb3e711468617f2c9e1feb1d0956a09cf678de9315fa9e6bafd90f17e4e09b6548ac7aaf8b8f1dad80e588316a016992b7a86999f568cd42bbde25e2cf22950a90c8e320942243deb9d6f0c4818b45c3607447b3817638ddf9babe7ec869f27ee4d8f2730875c6683161ddab48fb71d494ad3854be2f5365e61ccf25846484ec12564d4986ffc6749e208427c70977dfcad93642718dc9404333b2ed69c19799a502caba81209b3ab345b99eb5e9e627e6e02963e38b6d01ddba53c8410d2fc2827fd2d01d71a035dbb89fbb4189451d2edef82858a9ceb1bc09203d9236838f882e58f22cb61faf0d3b8eb790a131903fe082a15247bd5d699612bfaac2242ec332a1a05e08651950de9491de9b2ec90d664d68d4c06ac3ec6c87504f3b0bb676abeeeee931349ec2998d75f17b32248e93e90c2dd24ec7e348116264752f6b53d8d8853f1d438c489ec163fbb5f0feacd6e88047ea340b8b961916dd37d9f5c6b960e99f75475a13a294011ab7acc6b64220c5681ccfaf6bac0729fb9d67d33485f15e6b0c3c169a489668f6b2050d40c9bd4299d6f84500e49dd5d1d5d1c72849a644563b6be01ec7697636b4a517cea015996ff56c79013976e5f124308cf62da5be72d74ffffe38be158f0e4dcc3c1ad8bc5646801952f580683e3678f26abd1630823894d09acb945b21c53ca66fbe45465fd16a9bf2e0c3f7291f1dfb1e5bd863fd613bab47ab7104d21c5e7089fae34dcacfc1322c85da30b40e003d4e4e05a00d4c8a6254389d75477087664b67e0b36e6fa7eb4de812f7b794f8db9e7bda25e3d8df2100c24ffe586414ef3a1f52b74cb23f65429804824bc78bbed768905dd0bc2da77dde2d2ab5fc067501f77f1639c1803dbb0dfa1e0dac2d4a8095bc81a29a22ba148a07e3a15b837141161af679a1460ef12db50bd0a00257f8b9dde7265a8b15c1a71c2d92964bc6b78588eb72c66717dc86dae0685556ea9df2c7f2a0faf368e30b5462b2445713d330a2b29113b3eff34e8ad3d350c7cc5963352a6148b12d8e655042ac9a6d649b6fc4c25400543009393bffe1dd70cb1cc282d93cbdf8d4fe3d725bdd4276091e88d5a0c4557cf0ba4eb08bcecb10f3fab0d9662f4f5a7586d61a3d3fa978cb2549f41cb45001a45dd6a7f80fe50a384f29d6a0ff792d92180ac5b22a5b2b3693399d0b4732fe530f98055d22bbdbe875d48db37e52e539ac1b68ed3e8801015607899693be22a48e8bfe11286caca22c5d2af91a6cb86684c480c0fb51536a31683c025da7fbdc58bde9fb0559a4940d2c7a11c7e8cb6e5ea5f90fe805698dad23cb205826b90c2d1e2ece5d1c41abd4734a2852952cacde295cc44a1a0b9dbb7982b9b2b5df734f24885a90e95ebb0c926b42d9012591ce4ad8c1807222f8ddd8cf90dde1fad35fe75dbe665ab0f558b7ca5dca5790b360a6d229efe1cbe4beadb704cbb3982f5da6672c542f62c40317a0b4390526465170d34db5a0f9bc86ab4baa7d51475f3a05bba44d1823de033a03f43e47c70f92c4ea1929c3e937f2f9d25cfe2dfb465eff9e85243c769bec972ec5bf1958c50441423a9986c07658cc138099954d5c16a3d70c29307984602f7c1a598a76962c540f5a37c5a330aa11ffcfce9cad65fded48a141fc14aa63365f493ff86b7cd2b2141513f621fdcbb7c741435091917fd319b4b1664a42a60acdc87eb63fc693393b1a890bf69282543b298695b8e66dfbb0bb9b1dec2c7f3da00838f708c598212f29afba9975b43c78505869671f9b389720801077085d1cf0cc1df84e472510d73693718ffad2648942f0bcd64da0106369d85dc1b4b01614516d45746491e8ed8961d8ee7d9f42d582962623c4e7c04ebfe69e63b340281774742afab97391934a0df18844097806bd7d65440bf13553d34eed8dd76d4980ba86eb169b924e38a5baba73fa8d3791d5a9b3a1e8335eec704d1eda5b43628a4e6c8448380a07de320369d8ccc0925113793eaba2cb5d41eb3edc3c24349baccfa613d23fafde87135bed9e4d22999d970204cf21e23f3892f8db0dcfc53acc1e256057da5ca030440cd9f4417e2b449c38be3bcbf0e0fd44d126d8210419e5ab321819f87f35903f19e42906129486e26fe918d2dea0043704853b42a538efbb33dbd807d59bc137fe029e5293655d80333dcac384ccaf923f7311734c3ee71e89c419cd95218c866981b455b18c7322fd239ecefffc4861147d24950c34a83b560f926b35a1d2918905cd6086c26402ad5e7b3e757155faf72ecf4046d5af52b821161b981ca698e06434494a895a0925049b1d02d3fd76b49b4470ca90452793daef64e95555adbe1b20bb08647174db4229dc9d079c99edf24294185505613df7d1bd09284c2a3ed93f5aac6161bf64e0f92ce723bb65a1b42c82a9184152614e9ea920d24be814f79dc32a9df9c1a6b5ffa47671583ea749582a54628a15d0368d36a9d35ecf9aaeaa4fcbb4652e7fec7caaf6f64e03c251398e9fee2fbd6e637dced97404a2d5746c7bf2282ba399a5ebca40fb48e8550f75e4073b502f15d5e83fbff75f3f90b04c5adcaecd2f28f9bbbed27dad231a81c38c9eb6854da56c87e91b111de6365704701eb9e1bdb2f0d8efe135a16215274016e34ec036a35642cbd8845e3530bee8a2425ec98eac25f892596387d4d4914bd991c12c1f68ba9d88a8d428c2aec3323eaf28abecf2972a91b7b7491a1208fdc5186f62017766a8e54fd9d7be986d36fef1a7c0a674f66734a5eeba00469bf1bd68d3c934810bfa5eb49c652b16d01e99c42623b981cd65de253b378622a3f9ac0c549541fb135f776ac321ff72374a67589c6f1547742788fc5bf1ce13a97f3b6fcb3b776ebd0ff00df4f2850ad4c2445d26c5c9437c5cb48013d8693b0bed7f7ff5d2e08d8a4cc4d1f5bf9ee63b14ca5158696f20fe9140247fe0237ed833f1cea42425ceef5374af6cbc3068c01b9d7fad25ebc4973c38861f1483e9bd7a0974bcddbf354a6fc4fad6fd08a9dd67514fd72d7ff839e0b83e3d3c22acc7db3525f4cc1347f3e7f35ac126458bce2532a6d80a16d439e7d690ea5665dcadffb45808e51c70bcdce31f9efce86be7b117c2a57ef93474e220925debf3355f4a7a3b170d086ae52b017055c9ebc1826ec7d38ea4271b7c2cfa730c8a095d066af098ad969442b5667692f1563c5c3c725742bc65e02ef0871cd317b76c9c2599e80b1af6b8806d23df8096f5f84ed0ad1753b3bcbb7f42655afe1301af7bdc9978f44603203b6de2b9bb71a81764b73d146e51ac8bd2c24ac5d3197aec25fd47fce750343e8fe928e6fcf9f31e4c70c7a2b37230f379f7f5c402c61b290f252360f2712c881fff784ac298b8c5b0a82595404b1d295e72deae7f53ffddbda41d7713b2ab6eaae151f0624987831742c2bc2feb5395c9b237f376e4339cd9b6f86cf7de8568f19f26862627e3264b516e2c2dd4ab13e73e0df8c2f400f7824486d3b9bd4096288d4fe7f056bfa2732f8757a54f2b6a41a0cb1d5cfa8e97c84d3ae0186dbe8b3e36c7202dfb50f1a85f18af54ff072af5c115991ddf3c70c5165a523e8bf2aeb50d66cc850f7c557a378079fa9e30b0904130a204699a37c96383dbfffe095282acf0b26606e726135a4a8d684a9c1a05375106cdd8fb3bb2d99c9fd30d6ca269acfcfb1b5dadbddc5bf9d5d213bdfd3c40a149a12ed2ade09d2ad12d51a51c82e7e390d2c30f3986d60175aaccbfd2cb74a15c30633649cca60a069e78dd8b890a98a9068f8055caf8e05d0948a7a7aa699f2bebe54f788d7c37dbd0d9e2980c39ff8e0846bcdcd5e79ecd1a570722158d5f82edd6269207bcca9a2f49f845ce8e1a7bd356d042d0a7c312cc2813a32a842c1474c46502bf125a22973aff15913dd0ea92ee4a61b6275523178011a0ebc5aa8cae4a5210c7408b9a1fcc8493eff959088f1af20cc7c5066c3803cf237a14f76b35ad6cd76d6c0828647599ddac50b5f443dfb9698b3b784c5994cd93c3925b4afe8da58775a67a2c8555184e48db95544c15fe33f29051b26cf9f7ddcab85ed09afc4b9db34a5430bfb93d5ca4e90ad6ee9ca4ac9023174b870b7465f14ab17d3b9f3386c0435acb32b61424e0c3417ead368016c047f84c9b1cc5260813139095df6b76e9652e06a9a76677095f883e465923d7bf1b4dabb6ddda1d46b8f3dbd16202fe2e475899cd9e5ef5c0ad753da7bac994a0088497deec294a6a1112158833e82dc6a44a9ff1fd59c510b80b587ace22d4d44ebaa3ed3e2820ae086cca9688c092a3c9d25173a47d1422f986bf8b0ee7a7f024c3e3465b50b7adf665523d8a7ef337597e920aa2e586811138c838f708c3360d925227362337ed758052423bac389af7884e806caadc66a7bfebddff270e7e40b8a6ab9cddd89d7f5290bc9b6cb4ad3784548560e250f891a60fec93944f6ca5bb17f5ffae2ce168d7c983d5ca4b0f128ce35f9880829ec671581d05f18f607337af6116c44b9b95c70017afb5be9c6aa7d21831ef2c4ea8d2d65f19cc2622b39aedf1d940241f59159c76784a0083c962bd0500f81b933e1af413b08f732011140ad7e772a469daf5ee90cd8bd2dd66766ef0ef32dc7a5cff3cbbb80bd267608d842b8ac3505697cccd0d3296ddedd511fc15914ce70e85041b8678652defa5337e1389a8a82f988538f39f881284099a94211fce21ca56f79c0dc27f3e3547a6bb10d849c18edfd40530ad283025274c14bd9153666763442b8fe4ebb5128cd3ccaf0e82ebc74a687f3bd244288d2a454d2414d16d4be262150f4373c3052fc447c3262e53615adbb68f2ce91dbc16f938f4401b30a59da0c2b6e96d6a94e7c487520a731cb312dede62bfb1fa65df2e3ddedf8df34053e4a8d8f9576c728dffb66b041c70ab35b548b278f432813e11ce2bc7810592f66b16816c98c588561ad792997dbd9c5a6f0b745d0e8061d4fc5a0101f20ffb9434ad10bcae759d755ac7d219f540961fe3c201164ea2d82ae611609f81336effe6dc0bb23f7fc3f697642e1589594577cfa063fccd95ba42838e37d16b25f34d26919f0e576b595b838bcf2cf346b854ba1a53d8ea147b48cc8f72003de09ec007e2b6de9f4b5bbbbfc2830635e4e0189aff92cb1fcd5ec83fc414f585a50e6ebfaa4f632d0db92723a13463768585467ca506faeed04852e2080736e588b00f2fa0fcfcff6199c6c94c2b9a12c42a48af9b1c13a8bcd5cc8efcb39d47290a1f229932486bf8331f4895209b9e387ecb1080a10a022ae8a280fbf6ca129b69af8ec30547b111238b7cf431b0f2811d45e85d5d0ae13c4d0e4c869ee0fa708cf40d68f2052e52a619e1dfe93a0618a019610d2227529d070fd915afcd91668a3403e24df80df42f3df3ddd71a7f52977aee4ee83957e029794853ca04e7bf2913ed0d2899ab972a042b34d725db0fa89be306e2c84cd5ac3b579ab40e127094faa7fb8ded561fb4bf6abca9e7aeb348f5a05d2509ab38339d99bd20ddb135985663b551b961def8e06a515bc6af8a68856c64a2e1c31b42573f2ad2bd0d5635be28b86ac2b67777c140e651928d0740dd85de21083e12c8d2a37a47cb34a46bec5965d8820f61b42435c0646afc170da7cff4094c5283c18e6c4f5047f9d923127bc9c5f57e0287274dd6d6d86b58bf00bf13cbd71af4a2be10337f2740aeaba2cbcbe20bcf06158018b8fbe86010384476e61b99d05884bfd215c145ab86c6615a5123e642d491e20e2becc8a1d59a52e8239cb479180d0b9207971cae29e0433ef3bac7fb091d7810c6427ba6a57d8166ed44820bebb335a9d8a729af46a5852a92ab814f68a34a796ded6fc5a7b24ffc7ff7ee3a9527e9cbc60b9ec174ac5ab7ab93bee0b95266ae3cfc868ad73d50f0aace263876c1c5c1322ef5441c1ffe3dcd192de7678347c8de874a7b1a494f618a4f2a9ecc6d41690911900b2c11cc5a552d85c62b03fb6291f75e7423693c615ac8346117a3227dd62b72d9857084ec0d9eddf94c7c4adcf2ba1ebd77f65ab8707dce08ff180b7d22677f4fa05901f3b1c80e1f128c19ced3f49c6efa90493a6424898c0f85d62984459d13fcda0ebc3e9c96a1982b7af687c7f99216e6c82d6a237fdedb678e67deb669af6b4d312ed5a492fdaf2226423e0d7cb8064141c8f68eee8010c30d0cd33e29c64b9fc624ae089736a774046a61aed46fa01eae4a3514999a61deb0d601753d0ef937a430f2894df7f26407f34569faa77f62e7296782ea640a49ee07af8509977071bd07898db2724405c74fd3f2d774e6a806305b9bc52554e0faa006b62f856b74cd6a1d013a1a3d1254f4fec1fefd4847ba16dab8a0387f7477111ff525f314e934744e712eed86106dbc8b23c3e599637af0be228c62cd7d6f76439fb38f46d099004fd9879721e4715ae3b75a5088961a03dae654ca0dbaffd5c83055c14cd3c323f469e2b24264fc24ee39e36a6f1149392b745d562a750ad7967c4bb60d16e3e16d64c08a1df74282d74acd3665334dd6b290a34064fee560b46f7fe2a1c02622fbc8edd36f66e263f35fbb263982296fa1eabc3919aa94207a9b23e4eaee5d1b206fe5eb73724b226a125a7f745c18179f951e9e79e552597b284f11937485b3ed49ebe18dc2664e4d8449b0e5f0718c55dd6141c9a1cab60926359dd0a3e9285eaaf81d865478bd67af8be1413ff08c1869621cbc831039f757a8638824c8de6f362e8c07e749179fafb22b981ae7c01af9a9db67ec9ee74ec95612ef0a49e6ec5c77b2dad0d1eac159f59be85920fd32e1253fcd98e7844dd842894de433f275ae9c5313762a2b3030cab251c977fca65380e09e389a6556772d61b8e684ad3587c1636ad69368651eda1f0f5f43f15fbdafad83ce8675c93cec84361bfd1bef0bb041e9e92d4e1f31bf999bb4fde00557454d960668a85038c31f0b5c2dbe2e7a41ff32e32545fb75b379f275d5374263f051c0141337b0c05c5fbf46ae6899667f0be7d13c1ff4a0d66e0b92166b90416d2d892ae17cceaff0b4a44971c4f0e3a4deea764b18e956d24fe4edac583fd92dc01aae1d8cba21da99cc8bba6b1ad0feba72ae544e4454b1eeec15260cabcf1bd6e881e4253f9889c6702dab8444b7fe733a256854851732374219ef15467962e2057e357651666a038c9644eefe445b3b2759388f36101a72617e937ed346d9cf01ba3f7f41e31f0c2ba574d3cbc2bb3220a9124df67cb49c223061304ed339482f57154cbc7ffa50ea8f10b06d845f77eb86b2ba3586197162249ea0464712d06d54a0bb0e6795ffdd92e134d5c105c255ec7793e8f7cdc1da0b3e5239afb52ea7f133e5f0d4532a319c822a11a26a9c85a10aeb02654b76bf318e7f03dd84d947822b2ae1abd401a3fa2bfa14040611203bafe69eed2836e0500a3b2f23bb3f56639ffe5430b760803ef3e304bb36eadce00c4b0b0b12bf6bf25970638cbaf4da4af14579699ac5da1841789e75a3feb4d812a4435726f7ec6e69ae864a3fc36ddf35f514d6f13a99cc479e44ca0eac3437fda2288fd7a98739f2e4543b797a3f738da0620a3de9a60ca656ffa70cd3a631b7f70f065c06bd3f1f77272be6e19754a2cad7838fa942fd7b82cd21b198c192280ea61fc440364736be30984ef4fbf717fb80ceebd5590cd6ac1fda6a4fa39ea424fc7be90af631fb423b61fa847902972dbe0d5d4abd24aa6b7ee3a2205611c3c191eb925b8c97f60c220134f2552695aad598dd72b97b21566c2795e18970335158253931487f626858ee9ccb250af86199bf2a0d2b7b8beb96543b40dbf57eeb69f2965eeebbfa489ed9c8580562cfbdebcce3f45a94526ef5c2e5d7b6b69abc956d0b7ae5e239a563a8b421aa923661228ec781601f3f9241ce9650a2253478089dd8f62513f099d1cee152f6d4d948523bbccc750e4aa4edd8b3f906672ac9fd70a5d47eb4cea7dc2f4b1911e7425b2ad373dd85c33cd9530c8ee3cab89c0a26e8891a130bb492f6e3995811ece191c7bad229bbc70d0f5866faae1bf5ef0397f409ecf6196ff47129a853523b692d0190181d32e930c30572d6aa18c187f95b354648f23737cf3e30595248205a9861e7e10688c5d8a10c32b3c73c9d97ffb51f443a6c0807aee901c9d1608b59adaf3cc3623cefb3ae457da01a71c64ef4bb69661940cb64b715f9686f32348dfcd4a9727da1c01eb282486cbdab7ec53d199bed772517fba827c0a2db098b8e47e75b1cd2fac7fdbd24ccffcbf04ef03d8acaaa00cd56eb080c65818a032045613c67f288a64f5e9c4d7617cd311bcf49afdeba8fa68e62a70407b1ab1a696d71fd1618a1726ea64a6ef61b56061989c5773b20178f045c6649e97e8c265972ca905509d0777148c59b348a4a7333dab119e593bd570523af8de9864463d3428ebf09806d715809a6bf502334b4a3e4e06e7257e02e69c77fffb1142569a838e4f1fab7321972fb098a94abbf3ae09aa34db6c2394df72419db7ac15ee0dd1ef042856e8edbb17f3f09210978b9f7dd5035db8f2f5aeb00e48f3335272fcf15ade652d9f84fef2d55178f347cc15abfa5bc0282a62d01edce3b5be0c2ddfb2d8c375e7d8ee7b8f4df5d7606453ee6f6f7f1deb2fd48f31e82f78ce4617a82a8dbe2272a0a6d4170b7260a5da7c74f8fa4d42656f5e622e5a77626e369b241b54f7d46613b12ad914fa55982f84f9937e8905ce54f041527601f4182e7a6f154972f64e6ac8e4a10753b840e6ca5c83ecacabf2ee51e958e7899541144a8ad4bb45cca32778715f42efd064a9a890dcfd3efc7a780b858b255c5dcf14aa6804ef1f74ab6cfc97f7124f574d03c9370aa2a9b984eb62410d9e9f1044c4f18d4bf46280721eb3ef7983f1267aa3258e6b8f8fe3ad040848f6ebba6ff5266901041281d480ea3dbac5f2d6c6abca2f37e3f0672f3ccd637f9486c83c15c9af54589c61b7aa495878e53267deed374dc23bd8807e060ee082b88a7d904b40d54b917308a07cb9a98468e975ef069e1cb962dc66e371e3d1265351df4f69629a68104bbf7d1afc439fd0a94e094569a6ed2d7ff10799df2f2b2b86e5097becb92adedc463976c38cff1543a0063902f9e4d4a5201bddf5ff70daa7d5d220d892fa0ad326853e6e180a7a9bcbc07225363c43d575d3aa17acbaadb9b22ffab63e752c98186daa865acc184d903da91d8fa80114389f24b522aa83e2995a90927bad637d66c2e5def8b535a225b00abf90368f59e68ab7020f0abc306d69f7a9cc6f0b641dd301b20607a23fe3b68f8580fa806b8d1267f8cf8eecc12d670137781a93d35f3f50c1b07534c737f0f56e6c839270231a1bcf8d97dd83f33adf0629ce1efecc671a56bcc32cca126ef7dd401d67bed7a51b54be8e8c78ad6c3b9d8ac8f8f36df3700a54b24a97e3a5ee58abb630ecf0d9349e0351195070e265341c1b02c9b91d6aad3fb34d64b7b2ac32aa2725c2dcf12daa22ee601db2b8d5e6f25de2396afbe8d719fd106d0b0ee8309f0ebe8f1529d059d117b8fac0a13efc32e5b295e5a4b07f189f69345588cb7a8a03bd60be80e0260b58202bb912e5ee3c71d567d2fc62e0ade987df1088b02de24a3c4b30443feb610f34c9b3bc0c9fa2197433f03b951a850f26993269cf5cc9e2709601bf1dd7298a29035d6d35425ca10abe411e3774b14a98583ba126f86751c1bab02835c3f90e7ea17995f811f46097f31ebfd0f238f5e0ed6b65b99de40f28434dc0ffbf66c5c455f65c4f096a5d34cefc6ea9fff41ec07ee8a08ff3d2077f9fffa6a97ccceaf8c248cd2c6198d517fa2a0266471b081610aaf9ec3058ded49d99a146450f980abf71888adf41fbd8c8d6370516d062707eaa979fd5cfcf8ca8c5d6156fbefd51c993fb2229375296c11adeb802819b92e246d9f159a874663196545c32e59a6a1ec74151555d576536a5b01234d151b8e39d3afe12289ba2d741e32b14a72f56539a5088857bb31834d87df8a720a3cf024b64ce5712c629878183ee13389415e11bbedb25004e32f64934711d448cee37dbfab9520f4a6ee2685d99b541a62a0023cba4c6c00d3a2bdf3ddc0a577859b398eab48bf102cc2bcfcf402dca4214d73c62cd4f874e97c0ce6d1243d9abbf4f7b73cf1274ae8bff2b8e8fc9946551ac6e64392a1ed9b38388137e5b2233dc456e21d09b45a8c8e45425c44041de09cc02ef51c711f2765bbd4708fb74e4e8eac7b50650838cae8de60cd9fb18ba366a22f203edf0d4ea2e1c811409a2757b40b19b57b50a9c9fb4a8824e38dd7bc6dbec576a8701694b044226bb82051f47b69273c3a395c93dce85f7b0888abff7314c00315666d44f5e6be9c33972dc309de19c8ce35bdbe2cec3d3a4ba0e7223b788bfbdd3c87b0b9d4e5360406e4b605b01c5b6cb24f466fc59d4510b3fc09090599523496eb5df3b5b94f670d7954f3fa912740f5f4f15aaca90cb1d65f0b05787d7e14174a8352ef804f80f70bb1e12bc09bcfdef8461527cf2171b53d7176073de70d646fc237ff361fcfb4afd8119b0e1d1f93eae4a5a090f1a0e1dc5ace4759c3cfb2f025d8527290372d0b4e66f0fd766bbefdea91edfdd6e8be16dbb75324aa37459b70489328ba192f268a21c838c0e7069c2c186022fe53003205c55421f5eae130f58c2c2c8bbed817e0ab5cf9a4956653ccce3474047e8eb6717af378f89fd6093fcb75c17f1b59e8686a08e9e43554c5892a015f384101096aba1a16db20c275c584f3422ba9042896925fb83c5bb221a6e74bbb811edcc9de3c61eef974ed39b79641dc19fcc6182481630cc00995d66d31aa5a3d1dab90a7566212763d15a5c3508500964d128ecb3ebddcb1cfb3bc52fd3a83223f81aadf2fdaca15eea882c56cf616dae2bc81a281b9cc9b491408b58ef06ef7fde6b9cceea6cddf852a0fc5c91590d2ac0fca386c4b38b0b9a276e5a451d688e907e742801cb31053413edf6e344f1518d027623de2be07fd95c42e853d6e0e856e8850ae65fcbf9287ce9fa94b7853019fc369b79ce64e91fae272d6ae9f09fdba2220fb50f99844c20ed6a7c68feed96571e7cc24316bb8e5f6d215cb78bc7cfa6241a3e683ac8f42cfc8563e1938ce796f85f002b51bd8b17f4615643a6781b52f6f2dd1a78bda3ff3045972b383eeb8341602ad9a049d7e12243f1734c49fd1d2110ac42a310361274639ca7c24796c44f45f5ea70f603312ed8339f0575788bcc647718268a3728bd04d596e144cba9734dbed7f2cfa734c7862d283c77ac116e0ccb52b564a45799df5d98aab0675a658ffb572ab705f871b29aa116e5d102005c9b5f33dc46bd68c4209bc36112b252041fe992e2ef9b80f2e4f8ce268cbabf6a6350d0a7905a0452bb86a4e43c62a9eceb5c37dbc2c4d827ee094989e4c643468f2ed99c7b4e8c5b688a09de803898c1e5a03c78278311d74d8af1d3398199c7ef613823a09f3af1cae42562e0c9977cb18e8ebe0cced39d0a7f434f1e84b6c7066a1ca0c2d7335c69c29f420fe264594235da71fac9b2eb65e96467f077aedefe62049dd4f4b7143e49f00662f9b67803ce01d79b58dd3e62c434c589f1f6d481a0d4859f626b262a6934eff8fb336583efae01eb428b1bd0ad5141d2bfe8c94769ce51bff42e45cff31560acb6b34948086b5046b62ff1c0c9d0b60595c5f634af0bc76920ddbef5952fc56f9bd3904a9aba0387d6a5713de524cc3d231aef20abc1ecef9213f471202041f98e8fba867342491999a488680be8e7ec9ddf1b46fafd5d7665e526ee671c200df7fec505af6bae4dc1404fbfd28ff5f8cddf1254e272f935c6903a6bbf9b615e0fe6cdd22b82b27ff4594bcef03019f511c5a04725edd240c71859ddba55a431aa25dec7d75b9e545f24dd6d4fdf74feeb3017a50c979b0d278de9b1e225180cf66e1ed8ca73893ec919c1a5017c6e6403d85ac60c4150aa4257f8b25618582cb12613d5015a1d5efc07d051b691f3edc5068056d9e863f230366f1e5d192c9f799392adfd42aa0958125bc594a1e58e110e75f9aceb5124eed1fd0be4855adc36b8142c382c82720580e3cbefdd775dc6fead4d67973671b42832115c83e6f91a66e151eaae53cf1d08c56666983967b810b2664df65cf35634a2dd7dc262d3456cd9b65b289a59e947bc132c499b3ed031ce39237d36a2e9d01650f0aa668773f137edbbbcd71ceb6278f143ff66b5cdf6b93663a5b413d094495c792b645c92921637aad881f7d0fa9f7a6353b3d53c606069a25e8bbd7a6b650e710faf2de5f06198f2f8bbab27f9480c436cd2752e668d6be4c69ddf48cd52769947ed4610ab5a31d6d1c12f9a194e2fba55b47837b5130b383cfa8cb324cc5d5af157eedae61c8ce05a15396b51fa594c0d1ddf22b79526de626280e5ffd353c1787a4d3270f9b180c57001626a1211357d5847f60c36b3066956c6b41c7b060e2f88f5661cba966fcd08edbd2837904357648e919d71e3802826c4601ff9ac7166d6e69033f4a488387e57b6c8870d72dfa6344e508f665ba7c9deb09d6c51142884776444f74a5a86969003eae975949e33a4265ad09f7e5d1c57ebe6884ab8494a753bdb47f7928e5b0159466856a232269f325116e2c23192531aabd7b0dc17a98a19004c697d6356e6ff0561ec4fbfa6b2042afee045259e07708550bc8d5b2ebd90900ddde6c66ac27cd1a3282e3f29b6196f578c52a140ded940f085fb7daa9baa8a721dda46bda94674988a81f38f75810a624e18b51ff4d5bf0c1b9c5f2c5aacbbe28cc8b1adec7da5516a83b0b8d3de631488ba99ab21a9706af8c3e0a1a09ea3b59d0d382414e2d7b117e71bea664f94c36bfef2a6578d914eab4c8c15cc0b9ecf4d3fe48a52e14d0bf9b2cc41cbb04013b56b40c2926673a11eb58e709967066982f90e12282a8d0f15af96b0ece73f1a1bf916875cf997ce28f22a3460c7f1c6a34398c7bd8c26d42f31121606fe713ddc86ea7da6b9e1813093e00102a922bbae359703e7fcfceebeef0f1c4674ff372d48f32f1aba3f43908c45942d2ece8fbe49a380c147ac6188896000c9fd465e41d6b90d9662e917d96bc9c37635238fe367701c0bca86c4aabe75ae73a24de94907e61f6a9c4cd9d680607e7bf31dfc4e4aaa6328e60c99b82e8256e56d97f408b17a354ef0c43b67085e4ba42a3fae1f63074e50ce7f3b015a664595745452aa85a306552a752e15465ef24f181c804a0173195a50420b6e9c3c1dc600762f5816b5b7d745d103ea846b7b989094ef19ec9ebf1588c3db9497473ed36f177a9e5242099f54333cf5a9008153789b27b7fd384cdffe6c5f82229b3c03bd6f43d8bff769613c07a8de49725d5c7688d5e43512746e78a9ae97228757dd030c345d7ad2bc5e5e1e481e871699a1bd3dfffb330c4b7279ff47875c7999e2dc3c88d9eabd1c06bb447a675e52450947ce0e8ae765a45aae943529278b029ed58d51bd8800f11d26a1bb769bae6cb3f7f979fde5678973b9fda28fa6cf2935e27a0024296fd23eaf902ea12606516ca24cfb3b6cd4b30fda28bebfccad2f1dc3ff69be4b4e25888721c57af4439a67d23ecb3d4ea7d4f398be520603f8369d237fe0bcbc040566680890c65924c27d565dd25b679bc6fc94128d36229e149de3ed64614d8facaebdafa7a237fe37cacbb74bc36dc26716ae2e264706578f6b857ca27fbc4df746c925fbf26701286dd930720b0446ec95856fabb35dcf119cd5c6267c14445a690ba3d39f4ec6722f005d17a920a2fd2af6ca9d7a1b6540e018624ec309c491f23ed2568f0f6e0e67fcbcfe68c86ab3cac65a1176ff6f969e2513fb3e2521617e8de4c3ab4ba78768e7c712f33b567985362b230e04dbfb7782da338aac21f8564c0d698fbcbb8a59b381200bf6d5c3d850fbbc953e7ac9beddda68f5776aed898b0cd38927bf10fd1ae84fdd1444f044aa9e4349bf8aa98231995a8cee9439697356fe0e7dfc2f4a5df19b0387dcd66d58350dedda3a3167734d23d983c15afcc84e3d1fd3f1ec280849d36391860ea4ad80fdb6d96a6e3f0eaa3e93af9bb900931f612610807735f5d0f8c77473b7c04ff5405817c854717fb6400655ca928beff15855bbb376bcafa676788eb606213c34e44d9035daef165daa41450f17e7c07ff9ffcf02c1ee16d985d8c694d7c8616d5cf15c8808f909d9e45c76d59e8b3b9f0d8b625b6a3cec186adf1bf244bd9d98924c5fbc42ee6c84ca24699bdd61dc18b0067f088c6ce97e571c7616c0973bbb1c56dcef6db476c70dce78536c5cb0d3432e801f4f434c2d8b78e4dd6d14b6be32c08a4a7e8d1fa025afc467270e32d85644d3c7ca0a8bb53dc9a520b3a7abd686af11d356319ed80c16f8d043f9b2dbd4c2cdf895b1ff91f127bf2e255e04bb84bd3beaea0df5ac332788a41693ec605c3bbf5714aaeecde01510c72f2a03dc5e34f589f2937a2378bb1c4694bd2b0ebdfc250e981650499d59b60e701ac01077271e86ef9e2a09262087a40c72c58dc28c8da52199952ade5a3be0c6ed871db067d13f8e5bf56c620a207cabbed816f0e803c9e11fdbd97ba00cbb1075ad6c5e7861751f785768873f59f477ee20b8d4a770b15ba54e58577fac128d71fed79cf6b59fbba529bcc919377cee73097e203f9d65963169ee0680bdeffbee7a99b716d05142ce3b3586ba2680f5576e3629388fdbff73ce2fb4f9663b124f7ac124e2b2fe45be29a458145672f3a1d5a107ef510da5f1d28242ecf8fc94bfa67426a839abfe2cfb86aa01561f0533e1c2610c176038a055b02cd2662fd89c95b7add8319171408efed3700f62d402ff0f34ce11a451e29d319d7d62c928ff3ed61d1d6f050e818214875e279342f2cde79ed972c9aeb67964bf948833423ba8ece0051e539c6c2b07d07e9daa585e7acf56f476dc6a91f420e1310a959b37c74c4d6b261ca2143424f3beb90b1b620119cac8c404fe95b678a0ac5e5691ed4d5f0cb54b3f02485c403d3d0d2009ec0b8842f348fe06647595c6fe2e2f82fb2d628e4760129e891dc03b1600b54fdc9067cd9715d2e96e893314b489268dc71718594b685a2673f30da2f9d13de031bbe0c1359b8d2c2337c1e51a808ab1fbd9e4f7f051cfd104dc95cfa55e6f6e2a2171b46b7afb3dddbca01ed0f5e683216be512c7ff2744ff48942d08fcd46a386e4815fae1dc0438e7d50469bb875d484b55c52ef15cdd12a9011d397539784a6168d311a036adeac20a10ea016a24c513fa881ceb2e9f2afeb4cd93e7d3942a88712f9c361d2f27cdf4ccfdd81dbeced0415feba1caa8137e2ecf052764705a9f0746ddea9ba39ff0a6093e6d8da44ef8bd1b9f46580fc44a9037673131f509dc9c3dabde42746074958ea8ad043df67138a78769d3f1114c9646aa0b69cdc254c7d6da0ce0fb7f873ff58040ae68019c7de639503b448647558ba908c8d980a4dc415a229fbee65a52fee80df95b92420a9b201dfc0a25dded374a8da053e34b1f26ef2b12bf2d3fa5d2058928ef10a8380585d69de026e2190bbb9b80ea4ed5b53684eddae84e88944fb9a58f4a5505c1e2e08d3dd739f2ab0ecffcd7ce1853c0b28b0be414ab2b5ffc118111cc58757584893b723785d563a3da452c84bb751dc870c5a6694a7363b5cdabc87338d2c5613edf61e4cbcf3bdaef3a132e04893e575e57094a7c823fabdeb3b9825d61d2986091a10c84717f3ad40aea60f6f5b938de342f284775d8c41f2d5627e1c89e685f89254e857b0690bff1e9f1fd1975be59123b424afffcbd7d4958957c16196e015e69f69ab36e2df8b676313f9073e7966e68fd943d4d1c3861f41f2d860cdfb1c0060c0f12fba4640c9a09e3734b7773a108e73aa9be902dd1774a39e628c8e48ddc66f9eaf136e34feadded16af49f529661f6f8f9074d3fc05be20e54b74f488b9f43b047f7e86442896b5fc0e028d5ce5b622c32e8fa9b0e54697312cb20540f119205621dfec553b4f385ad237869857d49659588d522ec42e777691b05e841bfa8909c16c0c6fffa2281e4e17ee888b12cc106c94fe599450c33ac2797f2722fa8afd0606966aebbed719e596236a1eb4ad56172bf0e22a317f60b28cc392fafcbd670456594cfd71db7b993097578b4f49e08293d95e22f83ca98abd00a67ec02a687dc9869d2ef021a3a89ca1a110cefd99b664ce5796c72fb5f60164f22e8c540161a983f6f20d9052c2feda434c703abd21d83a437d3172ff96c2938c5e0b8eb479e8dfd866ecf4b24967abd79edc3832f75db4a1890a26f437132adfc85b20dacaa6804a4db962d0f8f3c414c1f88dd1d6214a2bcfe05a72699d293bdb3a841104c89938c93b980161dd9f0167ef957c13bb29ece70f81f9cacfcf172b6b6ef6ea6c19d65b4d86671faf352d2342f39024901793f3614e3709edf5164a5585f0014e8bc04a354ad70d8de12d1fbd10794226179671afbcf805b9bab3e70a7cd3550b31ab046bf2759365a776d2f42849e5378be4137c0452dd95ba1a14e62e65a97e96852559b6c7698bad754329dc8c8a52be9b7759edc38f934b7dbe2dfeac9cf760be6f724fadd6747c2967a8faa3d9153d9a9f94ae07ec675c692a58add2269f60e343988a5c8389f2ca2a0716242c112c8d7035829903afb1fd4d245b47f433e41af554e8ad6ca13e9c8f892d0be3c7d6dc41e412b13c9439e6562be83f539e98972e8bff5d9e57147f1bbe60d7c06b85b664602b5de086e2c180b037c0b0e786bd73b1cf549c0ccd79d6ba29e9f92fed6233cc7c44072171c5f3b7b697da2ccfa0cdc0a5912a9dfbff719e3f9114f9493667e52fea663aa446e2a5af7956a9e046f7244f6209cbf4741c317f9cb5849844b07835d89a6a9f5ddb87714ccea344a7bdb682c4e7dc4d81f1ab0bfcb73276570f13056d80974982bae2f09cd671280df41c06876ec17aefe70cc5b9b82a67193b7e9f6f450072c9532877b840a368a420fb8c30e3322bc479e5a0806e85d9f12b4c04a877c2f691de8b462cbd5f071db0ad03fe72e82fb6e3249d31d4fcbf28a722dd1985d84e570ed6413e165e3dd251bd335ffd9aed6473ed6b2dad50579a8ae80ea9855de96e27e0e9be3c0b2a1eec1f7ab8ba689e11d34ed0e96caf97b6878cf8616a79e2802a8b794d4d164795492318223480d94d98dfcf60a6a5e223ba4e9b771d12a17be55fa89d5b29a8ff9773ebb537ad152fe39291cedfa762fa917391072e1f614900b45d57ef360c421611fba5d2d7f05d81de6e09eb95916cfb68bd08fdfb24d6dff91d7787b354012b8d1d47dcb755ff0a9076550773858591c5f5de3a2d197f1344ecef06209c6bf982f9a0f94ce629a3ecc6e43ea2c8eb1a7db15e35f0bec34591aa55e850b8ee7715e75e5cf5bf30c10e1cb3bfb16617feea33db6504e9ac42db5e837ba031ad3c8850b71c2269e34b14c81d1d7447bb9afd6f4744979917c57ae277e576542a07934f06844ff7ae78914bda4be8359be1d33385a477e30ec22e555310abd682f22ee60499eb0c1a3423c4ad551f9b9ebb937e6c519fe5a1ae04c7d71d003e2a11fdce9ecaa41cb1253121f7d7e81c2447c22bf1f2222c6a597405788a6dfb441d679a11f50e341422b2642097a75edd794775be5f52e9560228c0d6a745f8b8772aedc2aab0e6b5c80b2b37b571b623340be76e2abd6bc69157c5440c5fc3812b60f7e332045ad7292892fca832f7c7a68b7bc5e75ce3d4b36675604ebcded29eeff0623bd9b97695390a1781a80994df846a01537ee6f7885344da626155f143563b93020efcd7132b594db58db94d9c9bc0bc9f802e7715c6e792f6982d57b630c4205d7c5bf4ed0f1baeb54a2e0a8b9f89b5131a10e68bf190c907039948e2c817ee5e786cd855f198d01d46fd9ed45585121b740e37ebc9dcfad5ba4baba37cf2d92a406ce809166c736a292cfd021e2055e5a7616082d6bb2495e09c877cedde4effbf4a3dfc024f9f28eb07ec940013e42f800a867605bed7010f3e4019332c117878213c9233c3f838205f278110acd9d63785b3d9a19d8caf61b1d6cfcb1e7037a2e7d90848006705459ee467802a5ee7b0400a389ab51a6ccb61c33e1b72800f22e6c3ac4a860e2a23bbe4073becfd2f06de620412e2a7444ceefa04fdfd7576d927d1822c67716488cc24e99c572782006512c8775d467f718b563227da28ec84ed3b4ad8c99344e7a678c634795f379424bed8bb357dec7cbd1321ece372e7c047c4b9e51046d42462d957c09b371568e973f44d9482e896b851dcf602580414c9f91177ad9cef751cd9b67e18df5f38e1daff4725c1e00fc06803dbb89657a4699573a221708f750f7b8fd07fb45127c5d3a700fe25f066f28db5f3f9b117bfe734f69cc4716b1d0c3405ef3811f007744a92456aa4c9c57a99a0e3adad952d48879193363971129c881ac3f22863a1b9cbc135099da6286716d93e1cd33774593050c6a77d063544e5d9e2ec1e307c1434d9a7473712bdf048da3582f94c23de9fdc784c16f225ede7623b5eb046896b57534fa4a21801c83f4c29aaeced5735c2c137b8e050e1a7cfd3667f67e06fad62da2bc95d45c455c06cb9f1f2fd0780da9891905042aeab72f81f37fb03cae8b7e173a6d39adce140f2078c161c87c1018aa5b2608cd320a5c05a6759764a206bb6f6c65056827d79cc88551c5865ef40dc0bcb8caf0f3a73dd233020866675fc823d6995386d835d8a6f54ab04e7421df2cdb1a125f1bf0bae80797693ff6a8ef945837198a910a31e84b4e358f343355eb9453bfd96af1111c8f3342a536f71cbc3f4ab7ec2940f594f9aef653b16c8c1f2f53b8435fb303563622edaaa41544c41bcb11e44fbbbf027626f648d9763e0ed4f582d9d2d8a5f493d0bc36ac458519</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码才能访问</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bruce Liang</title>
    <link href="/2025/03/09/Bruce-Liang/"/>
    <url>/2025/03/09/Bruce-Liang/</url>
    
    <content type="html"><![CDATA[<h2 id="我不知道"><a href="#我不知道" class="headerlink" title="我不知道"></a>我不知道</h2><blockquote><p>我不知道为什么</p><p>在日夜煎熬</p><p>为什么烦恼</p><p>为什么安静不了</p><p>也不知道为了什么而祈祷</p><p>越是不想去思考</p><p>越纠缠不休围绕</p></blockquote><h2 id="黑夜中"><a href="#黑夜中" class="headerlink" title="黑夜中"></a>黑夜中</h2><blockquote><p>黑夜暗自无声</p><p>天空也透明</p><p>身后那片河水</p><p>有没有结冰</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在坚冰还盖着北海的时候</title>
    <link href="/2025/02/25/%E5%9C%A8%E5%9D%9A%E5%86%B0%E8%BF%98%E7%9B%96%E7%9D%80%E5%8C%97%E6%B5%B7%E7%9A%84%E6%97%B6%E5%80%99/"/>
    <url>/2025/02/25/%E5%9C%A8%E5%9D%9A%E5%86%B0%E8%BF%98%E7%9B%96%E7%9D%80%E5%8C%97%E6%B5%B7%E7%9A%84%E6%97%B6%E5%80%99/</url>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2025/02/25/3IyXYHFa4rzDQ2K.png" alt="2025-2-25"></p><p>我自己在北平的生活是十分困苦的。我住在一个叫三眼井的地方，和另外七个人合住一个小房间，我们全体挤在炕上，连呼吸的地方都没有。每逢我翻身都得预先警告身旁的人。不过在公园和故宫的宫址我看到了北国的早春，在坚冰还盖着北海的时候，我看到了怒放的梅花。北京的树木引起了我无穷的欣赏。</p><p>节选自《毛泽东自传》<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[毛泽东自传·第二章〔记录整理：埃德加·斯诺 1936年7月〕](http://www.ziyexing.com/maozedong/zizhuan/maozedong_zizhuan_02.htm)">[1]</span></a></sup></p><hr><p>知乎<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[当坚冰还盖着北海的时候 我看到了怒放的梅花 - 知乎](https://zhuanlan.zhihu.com/p/433186574)">[2]</span></a></sup></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://www.ziyexing.com/maozedong/zizhuan/maozedong_zizhuan_02.htm">毛泽东自传·第二章〔记录整理：埃德加·斯诺 1936年7月〕</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/433186574">当坚冰还盖着北海的时候 我看到了怒放的梅花 - 知乎</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pve安装及配置</title>
    <link href="/2025/01/05/pve%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE/"/>
    <url>/2025/01/05/pve%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p>咸鱼捡垃圾碰巧捡了个华硕B250M主板+Intel i5 7500，碰巧捡了个拓扑龙的8盘位机箱，碰巧捡了个pcie转sata卡，碰巧捡了个益恒250W flex电源，碰巧捡了好几块机械硬盘。折腾一下pve。</p><blockquote><p>主板+CPU+内存条：￥350</p><p>机箱：280+54-20-90+118&#x3D;￥342</p><p>PCIE扩展卡：￥35</p><p>电源：￥283</p><p>Total：￥1010</p></blockquote><p>还没算硬盘，多少有点贵了。不过相比最新的硬件比如N100什么的，还是便宜不少，N100主板+CPU套装一般就600左右了。</p><h2 id="PVE"><a href="#PVE" class="headerlink" title="PVE"></a>PVE</h2><p>Proxmox VE<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Proxmox Virtual Environment - Open-Source Server Virtualization Platform](https://www.proxmox.com/en/proxmox-virtual-environment/overview)">[1]</span></a></sup>是一个基于debian的linux发行版，开源的服务器虚拟化平台。</p><h2 id="安装PVE"><a href="#安装PVE" class="headerlink" title="安装PVE"></a>安装PVE</h2><p>使用ventoy<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Ventoy](https://www.ventoy.net/cn/index.html)">[2]</span></a></sup>安装，如果ventoy版本是有bug的版本的话，在安装pve的时候有可能会遇到No Device with Valid ISO Found的问题，似乎是ventoy的bug<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[\[SOLVED\] - \[ERROR\] No Device with Valid ISO Found | Proxmox Support Forum](https://forum.proxmox.com/threads/error-no-device-with-valid-iso-found.134510/)">[3]</span></a></sup>，更新到1.0.99版本就行了，但是后面安装好之后，还会有bug，无法启动。表现就是启动的时候会卡在<code>Loading initial ramdisk...</code>，然后又是google一番，发现是pve和ventoy的bug<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Ventoy install of Proxmox 8.1 halts at Loading initial ramdisk | Proxmox Support Forum](https://forum.proxmox.com/threads/ventoy-install-of-proxmox-8-1-halts-at-loading-initial-ramdisk.143196/)">[4]</span></a></sup>。按照帖子上的说法，编辑<code>/etc/default/grub.d/installer.cfg</code>这个文件，删掉<code>voty</code>参数的部分。我的改完之后是<code>GRUB_CMDLINE_LINUX=&quot;$GRUB_CMDLINE_LINUX&quot;</code>，然后运行<code>update-grub</code>更新配置文件，然后就可以了。</p><p><del>世界就是一个巨大的bug，为什么这么多bug。</del></p><p>如果显示器显示登录的界面了（只有命令行），就是安装成功了，然后按照命令行的提示，在另一台电脑上访问web界面就可以了。note：必须用https访问，可以直接安装这个证书或者后面自己配置证书。刚好可以用之前openssl自己创建的证书。</p><h2 id="配置证书"><a href="#配置证书" class="headerlink" title="配置证书"></a>配置证书</h2><p>参考<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[佛西博客 - Proxmox VE配置ssl证书](https://foxi.buduanwang.vip/virtualization/256.html/)">[5]</span></a></sup></p><p><img src="https://s2.loli.net/2025/01/07/vNc8PuMqoyEdGHZ.png" alt="image-20250107202845967"></p><h2 id="上传镜像"><a href="#上传镜像" class="headerlink" title="上传镜像"></a>上传镜像</h2><p><img src="https://s2.loli.net/2025/01/08/SvCL7mJg3dFsVwq.png" alt="image-20250108194753739"></p><p>上传的时候可以选择保存的文件名，以及哈希算法验证镜像的完整性。</p><h2 id="运行虚拟机-CT"><a href="#运行虚拟机-CT" class="headerlink" title="运行虚拟机&#x2F;CT"></a>运行虚拟机&#x2F;CT</h2><p>右上角创建虚拟机，旁边还有创建CT的选项，根据查到的资料看，CT是进程隔离的技术，虚拟机是完全虚拟出来的操作系统，虚拟机隔离更彻底，但是资源占用也较大，CT进程隔离资源利用效率更高<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[容易被忽略的PVE细节—PVE的tips_NAS存储_什么值得买](https://post.smzdm.com/p/a85g06k7/)">[6]</span></a></sup>。</p><p>先创建个虚拟机试试（创建CT不知道怎么操作）</p><p>输入名称，选择ISO镜像，显卡bios什么的保持默认，磁盘除了大小调整一下，其他的也全部保持默认，cpu核心可以选满，因为按照资料<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[容易被忽略的PVE细节—PVE的tips_NAS存储_什么值得买](https://post.smzdm.com/p/a85g06k7/)">[6]</span></a></sup>说的，核心并不是这个虚拟机独占的，pve会自动根据权重来分配，核心数只是一个性能上限，并且还提到了cpu类型选择host会拥有更好的性能（但是迁移性会变差），不过我也不考虑迁移，就选host。</p><p>创建之后直接启动，就会进入到安装ISO的步骤。（如果想安装其他操作系统，也可以关机然后选择其他ISO文件，<code>qm stop id</code>强制关闭具有特定id的虚拟机）</p><h2 id="PCI直通"><a href="#PCI直通" class="headerlink" title="PCI直通"></a>PCI直通</h2><p>PVE的一个很火的功能，字面意思，PCI设备可以直通到虚拟机，比如显卡或者其他PCIE转接卡。</p><p>这个功能需要在主板BIOS中开启VT-d选项（和VT-x不是一个东西）（Intel）华硕的主板中在高级设置-&gt;北桥-&gt;VT-d，选择enable就可以了。然后按照教程<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[PVE开启硬件直通功能 – 杂七杂八](https://www.xh86.me/?p=724)">[7]</span></a></sup>操作</p><ol><li><p>首先编辑grub配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs conf"># /etc/default/grub<br># intel cpu加上intel_iommu=on<br>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet intel_iommu=on&quot;<br># amd cpu加上amd_iommu=on<br>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet amd_iommu=on&quot;<br></code></pre></td></tr></table></figure><p>然后更新grub</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">update-grub<br><span class="hljs-comment"># 但是忘记在哪看到的教程说pve已经不使用update-grub命令了，需要用：</span><br>pve-efiboot-tool refresh<br><span class="hljs-comment"># 保险起见两个都运行一遍得了</span><br></code></pre></td></tr></table></figure></li><li><p>然后加载相应的内核模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> vfio &gt;&gt; /etc/modules<br><span class="hljs-built_in">echo</span> vfio_iommu_type1 &gt;&gt; /etc/modules<br><span class="hljs-built_in">echo</span> vfio_pci &gt;&gt; /etc/modules<br><span class="hljs-built_in">echo</span> vfio_virqfd &gt;&gt; /etc/modules<br></code></pre></td></tr></table></figure><p>然后重启pve，然后应该就可以用了。</p></li></ol><p>在虚拟机关机的状态下，选择添加设备，然后就可以PCI设备直通了。</p><p><img src="https://s2.loli.net/2025/01/08/jMY2hdxbuOKfeCZ.png" alt="image-20250108211143701"></p><h2 id="Linux磁盘加密"><a href="#Linux磁盘加密" class="headerlink" title="Linux磁盘加密"></a>Linux磁盘加密</h2><p>首先使用fdisk对硬盘进行分区<sup id="fnref:10" class="footnote-ref"><a href="#fn:10" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux磁盘分区、格式化、挂载 - 大数据老司机 - 博客园](https://www.cnblogs.com/liugp/p/16417652.html)">[10]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo fdisk /dev/sdX<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs bash">Welcome to fdisk (util-linux 2.39.3).<br>Changes will remain <span class="hljs-keyword">in</span> memory only, <span class="hljs-keyword">until</span> you decide to write them.<br>Be careful before using the write <span class="hljs-built_in">command</span>.<br><br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): m<br><br>Help:<br><br>  GPT<br>   M   enter protective/hybrid MBR<br><br>  Generic<br>   d   delete a partition<br>   F   list free unpartitioned space<br>   l   list known partition types<br>   n   add a new partition<br>   p   <span class="hljs-built_in">print</span> the partition table<br>   t   change a partition <span class="hljs-built_in">type</span><br>   v   verify the partition table<br>   i   <span class="hljs-built_in">print</span> information about a partition<br><br>  Misc<br>   m   <span class="hljs-built_in">print</span> this menu<br>   x   extra functionality (experts only)<br><br>  Script<br>   I   load disk layout from sfdisk script file<br>   O   dump disk layout to sfdisk script file<br><br>  Save &amp; Exit<br>   w   write table to disk and <span class="hljs-built_in">exit</span><br>   q   quit without saving changes<br><br>  Create a new label<br>   g   create a new empty GPT partition table<br>   G   create a new empty SGI (IRIX) partition table<br>   o   create a new empty MBR (DOS) partition table<br>   s   create a new empty Sun partition table<br><br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): n<br>Partition number (1-128, default 1):<br>First sector (34-23437770718, default 2048):<br>Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (2048-23437770718, default 23437768703): +4T<br><br>Created a new partition 1 of <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span> and of size 4 TiB.<br>Partition <span class="hljs-comment">#1 contains a LVM2_member signature.</span><br><br>Do you want to remove the signature? [Y]es/[N]o: y<br><br>The signature will be removed by a write <span class="hljs-built_in">command</span>.<br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): n<br>Partition number (2-128, default 2):<br>First sector (8589936640-23437770718, default 8589936640):<br>Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (8589936640-23437770718, default 23437768703): +4T<br><br>Created a new partition 2 of <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span> and of size 4 TiB.<br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): n<br>Partition number (3-128, default 3):<br>First sector (17179871232-23437770718, default 17179871232):<br>Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (17179871232-23437770718, default 23437768703):<br><br>Created a new partition 3 of <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span> and of size 2.9 TiB.<br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): w<br>The partition table has been altered.<br>Calling ioctl() to re-read partition table.<br>Syncing disks.<br></code></pre></td></tr></table></figure><p>然后根据教程对分区进行加密<sup id="fnref:11" class="footnote-ref"><a href="#fn:11" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux 系统创建加密磁盘并自动挂载 | Sink 的笔记本](https://ldsink.com/articles/how-to-create-crypt-disk-and-auto-mount/)">[11]</span></a></sup><sup id="fnref:12" class="footnote-ref"><a href="#fn:12" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux 磁盘加密和自动挂载 - 阿蛮君博客](https://www.amjun.com/2590.html)">[12]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 全程root操作</span><br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/urandom of=/etc/cryptfs.key bs=1k count=4<br>cryptsetup luksFormat /dev/sda1 /etc/cryptfs.key<br><span class="hljs-comment"># 然后需要输入大写的YES</span><br><span class="hljs-comment"># 打开加密的分区</span><br>cryptsetup open /dev/sdc1 sdc1 --key-file=/etc/cryptfs.key<br><span class="hljs-comment"># 在打开的分区上创建文件系统</span><br>mkfs.ext4 /dev/mapper/sdc1<br></code></pre></td></tr></table></figure><p>打开的分区会出现在<code>/dev/mapper</code>中</p><p><img src="https://s2.loli.net/2025/01/08/YiL63UoFOI4gzuk.png" alt="image-20250108220027245"></p><p>通过更改<code>/etc/crypttab</code>配置文件来实现自动解密，使用分区的UUID来识别分区可以避免因为启动顺序不同造成的问题。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 先确认分区的UUID</span><br>sudo blkid<br>sudo nano /etc/crypttab<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs conf"># &lt;target name&gt; &lt;source device&gt;                            &lt;key file&gt;      &lt;options&gt;<br>sdc1            UUID=&lt;partition uuid&gt;  /etc/cryptfs.key<br></code></pre></td></tr></table></figure><p>然后更改<code>/etc/fstab</code>来实现自动挂载，因为<code>crypttab</code>已经固定了target name了，所以应该也不需要uuid来挂载了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># &lt;file system&gt;  &lt;mount point&gt;  &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br>/dev/mapper/sdc1 /some/path      ext4   defaults        0       0<br></code></pre></td></tr></table></figure><h2 id="Linux配置磁盘阵列"><a href="#Linux配置磁盘阵列" class="headerlink" title="Linux配置磁盘阵列"></a>Linux配置磁盘阵列</h2><p>组件RAID5阵列需要至少三个硬盘<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux下构建RAID5 - 流年似水zlw - 博客园](https://www.cnblogs.com/zlw-xyz/p/14075476.html)">[8]</span></a></sup><sup id="fnref:9" class="footnote-ref"><a href="#fn:9" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux下构建RAID5 | 《Linux就该这么学》](https://www.linuxprobe.com/linux-raid5.html)">[9]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mdadm -C /dev/md0 -l 5 -n 3 -x 1 /dev/sda /dev/sdb /dev/sdc /dev/sdd<br></code></pre></td></tr></table></figure><p><code>-x 1</code>表示有一块热备盘，如果没有可以直接去掉</p><p>配置mdadm每次重启都能识别到raid阵列，需要更改配置文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 注意需要有写权限</span><br><span class="hljs-comment"># mdadm --detail --scan --verbose /dev/md0 &gt; /etc/mdadm.conf</span><br>mdadm --detail --scan --verbose /dev/md0 &gt;&gt; /etc/mdadm/mdadm.conf<br></code></pre></td></tr></table></figure><p>然后根据这个配置文件的提示，还需要运行<code>update-initramfs -u</code>命令</p><p>然后就可以创建文件系统格式化，然后挂载了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mkfs.ext4 /dev/md0<br>sudo mount /dev/md0 /some/path<br></code></pre></td></tr></table></figure><p>如果需要开机自动挂载，需要更改fstab</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs conf"># /etc/fstab<br>/dev/md0  /some/path  ext4 defaults 0 0<br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.proxmox.com/en/proxmox-virtual-environment/overview">Proxmox Virtual Environment - Open-Source Server Virtualization Platform</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.ventoy.net/cn/index.html">Ventoy</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://forum.proxmox.com/threads/error-no-device-with-valid-iso-found.134510/">[SOLVED] - [ERROR] No Device with Valid ISO Found | Proxmox Support Forum</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://forum.proxmox.com/threads/ventoy-install-of-proxmox-8-1-halts-at-loading-initial-ramdisk.143196/">Ventoy install of Proxmox 8.1 halts at Loading initial ramdisk | Proxmox Support Forum</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://foxi.buduanwang.vip/virtualization/256.html/">佛西博客 - Proxmox VE配置ssl证书</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://post.smzdm.com/p/a85g06k7/">容易被忽略的PVE细节—PVE的tips_NAS存储_什么值得买</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://www.xh86.me/?p=724">PVE开启硬件直通功能 – 杂七杂八</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://www.cnblogs.com/zlw-xyz/p/14075476.html">Linux下构建RAID5 - 流年似水zlw - 博客园</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:9" class="footnote-text"><span><a href="https://www.linuxprobe.com/linux-raid5.html">Linux下构建RAID5 | 《Linux就该这么学》</a><a href="#fnref:9" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:10" class="footnote-text"><span><a href="https://www.cnblogs.com/liugp/p/16417652.html">Linux磁盘分区、格式化、挂载 - 大数据老司机 - 博客园</a><a href="#fnref:10" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:11" class="footnote-text"><span><a href="https://ldsink.com/articles/how-to-create-crypt-disk-and-auto-mount/">Linux 系统创建加密磁盘并自动挂载 | Sink 的笔记本</a><a href="#fnref:11" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:12" class="footnote-text"><span><a href="https://www.amjun.com/2590.html">Linux 磁盘加密和自动挂载 - 阿蛮君博客</a><a href="#fnref:12" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>pve</tag>
      
      <tag>nas</tag>
      
      <tag>vm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>appium inspector配置</title>
    <link href="/2025/01/03/appium-inspector%E9%85%8D%E7%BD%AE/"/>
    <url>/2025/01/03/appium-inspector%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="appium以及appium-inspector安装及配置"><a href="#appium以及appium-inspector安装及配置" class="headerlink" title="appium以及appium-inspector安装及配置"></a>appium以及appium-inspector安装及配置</h2><p>appium需要使用比较新的版本的nodejs</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt update<br>curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -<br>sudo apt install -y nodejs<br>node -v<br>npm -v<br><br>sudo apt install openjdk-17-jdk<br><br>wget https://dl.google.com/android/repository/commandlinetools-linux-6858069_latest.zip<br>sudo unzip commandlinetools-linux-6858069_latest.zip<br><br>sudo <span class="hljs-built_in">ln</span> -s /path/to/sdkmanager /bin/sdkmanager<br>sudo sdkmanager --proxy=http --proxy_host=host --proxy_port=port --sdk_root=/opt/android-sdk <span class="hljs-string">&quot;platforms;android-28&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">sudo sdkmanager --proxy=http --proxy_host=host --proxy_port=port --sdk_root=/opt/android-sdk &quot;</span>platform-tools<span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">sudo ln -s /path/to/adb /bin/adb</span><br><span class="hljs-string">sudo npm config set proxy http://your-proxy-server:port</span><br><span class="hljs-string">sudo npm install -g appium</span><br><span class="hljs-string">appium driver install uiautomator2</span><br></code></pre></td></tr></table></figure><p>子网内通过adb连接到手机，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb connect <span class="hljs-variable">$ip</span>:<span class="hljs-variable">$port</span><br></code></pre></td></tr></table></figure><p>获取包名：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell pm list packages | grep xxx<br></code></pre></td></tr></table></figure><p>获取启动activity：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell monkey -p com.package.name -c android.intent.category.LAUNCHER -v -v 0 | grep  Using<br></code></pre></td></tr></table></figure><p>appium服务器中运行<code>appium</code>启动服务，然后配置appium-inspector：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;platformName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Android&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:platformVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;9.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:deviceName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;device-serial&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:appPackage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.package.name&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:appActivity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.package.name.Activity&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:automationName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;UiAutomator2&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ADB常用命令"><a href="#ADB常用命令" class="headerlink" title="ADB常用命令"></a>ADB常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb devices<br><span class="hljs-comment"># 列出已连接的设备</span><br><br>adb connect 192.168.1.111:5555<br><span class="hljs-comment"># 连接到局域网的adb设备</span><br><br>adb -s serial-0001 shell <span class="hljs-built_in">ls</span><br><span class="hljs-comment"># 通过adb连接的设备（连接多个设备时通过-s参数指定设备编号）中执行ls命令</span><br><span class="hljs-comment"># 如果只有一个adb设备，-s加不加无所谓</span><br><br>adb shell pm list packages | grep xxx<br>adb shell pm list packages | findstr xxx<br><span class="hljs-comment"># 列出所有安装的包，重定向输出然后正则匹配，linux用grep，windows用findstr</span><br><br>adb shell /system/bin/screencap -p /sdcard/ss.png<br>adb pull /sdcard/ss.png .<br><span class="hljs-comment"># adb获取设备截图并pull到本地</span><br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/lixuefang69/p/15425471.html">利用adb命令对手机截图保存到电脑 - 曦涵 - 博客园</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>android</tag>
      
      <tag>adb</tag>
      
      <tag>appium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker常用命令以及环境工作配置备份</title>
    <link href="/2024/12/30/docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%B7%A5%E4%BD%9C%E9%85%8D%E7%BD%AE%E5%A4%87%E4%BB%BD/"/>
    <url>/2024/12/30/docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%B7%A5%E4%BD%9C%E9%85%8D%E7%BD%AE%E5%A4%87%E4%BB%BD/</url>
    
    <content type="html"><![CDATA[<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -itd -p 10022:22 -v ~/data:/root/data --name my_container ubuntu:22.04 bash<br><span class="hljs-comment"># docker运行容器，添加端口映射和目录映射</span><br><br>docker ps -a<br><span class="hljs-comment"># 列出所有的容器，-a表示不管有没有在运行</span><br><br>docker <span class="hljs-built_in">exec</span> -it my_container bash<br><span class="hljs-comment"># docker进入容器并获取一个可交互的终端</span><br><br>docker start my_container<br><span class="hljs-comment"># start启动容器，stop关闭，restart重启</span><br><br>docker <span class="hljs-built_in">rm</span> -f my_container<br><span class="hljs-comment"># 删除某个容器，-f强制删除（不用手动关闭容器）</span><br><br>docker inspect my_container<br><span class="hljs-comment"># docker查看容器的信息（比如网络什么的）</span><br><br>docker network <span class="hljs-built_in">ls</span><br><span class="hljs-comment"># 列出docker的网络</span><br><br>docker network inspcet network_name_or_id<br><span class="hljs-comment"># docker查看该网络的信息（比如有哪些容器在这个网络上）</span><br><br>docker nerwork <span class="hljs-built_in">rm</span> network_name<br><span class="hljs-comment"># 删除某个网络（需要重启docker）</span><br><br>docker update --restart=always continer_name<br><span class="hljs-comment"># 设置某个continer自动重启</span><br></code></pre></td></tr></table></figure><h2 id="docker网段与外部冲突"><a href="#docker网段与外部冲突" class="headerlink" title="docker网段与外部冲突"></a>docker网段与外部冲突</h2><p>如果 Docker 的默认网段与外部网络网段发生冲突，可以通过以下步骤进行更改：</p><p><strong>编辑 Docker 配置文件</strong>：通常，Docker 的配置文件位于 <code>/etc/docker/daemon.json</code>。如果该文件不存在，可以创建它。</p><p><strong>配置自定义网段</strong>：在 <code>daemon.json</code> 文件中添加或修改以下内容来设置一个新的网段：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br> <span class="hljs-attr">&quot;bip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;172.30.0.1/16&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>这里的 <code>172.30.0.1/16</code> 是一个示例网段，可以根据需要选择一个不冲突的私有网段。</p><p><strong>重启 Docker 服务</strong>：保存配置文件后，重启 Docker 服务以应用更改：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p><strong>验证更改</strong>：重启后，可以运行以下命令来验证 Docker 是否使用了新的网段：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker network inspect bridge<br></code></pre></td></tr></table></figure><p>检查输出中的 <code>Subnet</code> 信息是否与配置一致。这样设置后，Docker 将使用你指定的网段，从而避免与外部网络冲突。如果<code>ip r</code>发现还有对应的路由表，可能需要<code>docker network rm n_name</code>手动删除无用的网络。</p><h2 id="配置常用环境"><a href="#配置常用环境" class="headerlink" title="配置常用环境"></a>配置常用环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">PUB_KEYS=(<span class="hljs-string">&quot;pub key1&quot;</span> <span class="hljs-string">&quot;pub key2&quot;</span>)<br>apt update &amp;&amp; apt install ca-certificates -y<br><span class="hljs-built_in">mv</span> /etc/apt/sources.list /etc/apt/sources.list.backup<br><span class="hljs-built_in">cat</span> &gt; /etc/apt/sources.list &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="hljs-string"></span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="hljs-string">EOF</span><br>apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install nano git wget curl openssh-server zsh -y<br>sed -i <span class="hljs-string">&quot;s/#PubkeyAuthentication.*$/PubkeyAuthentication\ yes/g&quot;</span> /etc/ssh/sshd_config<br>sed -i <span class="hljs-string">&quot;s/#PasswordAuthentication.*$/PasswordAuthentication\ no/g&quot;</span> /etc/ssh/sshd_config<br>sed -i <span class="hljs-string">&quot;s/#AuthorizedKeysFile.*$/AuthorizedKeysFile\ .ssh\/authorized_keys/g&quot;</span> /etc/ssh/sshd_config<br><span class="hljs-keyword">if</span> [ ! -d ~/.ssh/ ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">mkdir</span> ~/.ssh<br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">if</span> [ ! -f ~/.ssh/authorized_keys ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">touch</span> ~/.ssh/authorized_keys<br><span class="hljs-keyword">fi</span><br><span class="hljs-built_in">chmod</span> 600 ~/.ssh/authorized_keys<br><span class="hljs-keyword">for</span> pub <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PUB_KEYS[@]&#125;</span>&quot;</span>;<br><span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$pub</span> &gt;&gt; ~/.ssh/authorized_keys<br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;service ssh start&quot;</span> &gt;&gt; ~/.bashrc<br>usermod -s `<span class="hljs-built_in">which</span> zsh` root<br>sh -c <span class="hljs-string">&quot;<span class="hljs-subst">$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span><br>git <span class="hljs-built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="hljs-variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions<br>git <span class="hljs-built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="hljs-variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting<br>sed -i <span class="hljs-string">&quot;s/^plugins=(git.*$/plugins=(git zsh-autosuggestions zsh-syntax-highlighting)/g&quot;</span> ~/.zshrc<br>git <span class="hljs-built_in">clone</span> --depth=1 https://github.com/romkatv/powerlevel10k.git <span class="hljs-variable">$&#123;ZSH_CUSTOM:-<span class="hljs-variable">$HOME</span>/.oh-my-zsh/custom&#125;</span>/themes/powerlevel10k<br>sed -i <span class="hljs-string">&quot;s/^ZSH_THEME=.*$/ZSH_THEME=powerlevel10k\/powerlevel10k/g&quot;</span> ~/.zshrc<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker配置transmission</title>
    <link href="/2024/12/16/docker%E9%85%8D%E7%BD%AEtransmission/"/>
    <url>/2024/12/16/docker%E9%85%8D%E7%BD%AEtransmission/</url>
    
    <content type="html"><![CDATA[<p>有一些网站会限制使用的bt客户端的版本，然后archlinux由于滚动更新，软件都是最新版本的，所以docker就非常好用。</p><h2 id="docker-compose-yaml"><a href="#docker-compose-yaml" class="headerlink" title="docker-compose.yaml"></a>docker-compose.yaml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;2.1&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">transmission:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">linuxserver/transmission:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">transmission</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PUID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PGID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TZ=Etc/UTC</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TRANSMISSION_WEB_HOME=</span> <span class="hljs-comment">#可选</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">USER=</span> <span class="hljs-comment">#可选，此处设置WebUI账户</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PASS=</span> <span class="hljs-comment">#可选，此处设置WebUI密码</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">WHITELIST=</span> <span class="hljs-comment">#可选， 指定可访问WebUI的白名单的ip列表，逗号分隔</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">RPCPORT=</span> <span class="hljs-comment">#可选，此处设置WebUI端口，默认为9091</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PEERPORT=</span> <span class="hljs-comment">#可选，此处设置种子链接端口，默认为51413</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">HOST_WHITELIST=</span> <span class="hljs-comment">#可选</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/config:/config</span> <span class="hljs-comment">#挂载TR设置文件存储</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/downloads:/downloads</span> <span class="hljs-comment">#挂载TR下载文件存储</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/watch:/watch</span> <span class="hljs-comment">#挂载TR种子监听文件存储</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">9091</span><span class="hljs-string">:9091</span> <span class="hljs-comment">#NAT转发RPC端口</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">51413</span><span class="hljs-string">:51413</span> <span class="hljs-comment">#NAT转发PEER端口</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">51413</span><span class="hljs-string">:51413/udp</span> <span class="hljs-comment">#NAT转发PEER(UDP)端口</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span><br></code></pre></td></tr></table></figure><p>配置文件来自<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[[Docker\]Transmission（官方🐋Docker版）安装 - invites.fun](https://invites.fun/d/694)">[1]</span></a></sup>（有一些修改）。linuxserver官方文档<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[linuxserver/transmission - Docker Image | Docker Hub](https://hub.docker.com/r/linuxserver/transmission)">[2]</span></a></sup></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;2.1&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">transmission:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">linuxserver/transmission:4.0.5</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">transmission</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PUID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PGID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TZ=Etc/UTC</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TRANSMISSION_WEB_HOME=/config/web/src</span> <span class="hljs-comment">#配置美化之后的webui</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">USER=username_of_webui</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PASS=password_of_webui</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">WHITELIST=</span> <span class="hljs-comment">#可选， 指定可访问WebUI的白名单的ip列表，逗号分隔</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">RPCPORT=</span> <span class="hljs-comment">#可选，此处设置WebUI端口，默认为9091</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PEERPORT=</span> <span class="hljs-comment">#可选，此处设置种子链接端口，默认为51413</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">HOST_WHITELIST=</span> <span class="hljs-comment">#可选</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/tr/config:/config</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/tr/downloads:/downloads</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/tr/watch:/watch</span><br>    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">host</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span><br></code></pre></td></tr></table></figure><p>网络模式改成了<code>host</code>，然后增加了web_home，可以用来改变UI</p><p>从release页面<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Releases · ronggang/transmission-web-control](https://github.com/ronggang/transmission-web-control/releases)">[3]</span></a></sup>下载webui的源代码，然后确保把解压后的<code>src</code>文件夹中的内容放到之前配置的<code>/config/web/src</code>（因为<code>config</code>文件夹已经映射过了，所以也就是<code>home/tr/config/web/src</code>）中。</p><p>然后<code>docker compose up -d</code>即可。</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>[<a href="https://invites.fun/d/694">Docker]Transmission（官方🐋Docker版）安装 - invites.fun</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://hub.docker.com/r/linuxserver/transmission">linuxserver&#x2F;transmission - Docker Image | Docker Hub</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/ronggang/transmission-web-control/releases">Releases · ronggang&#x2F;transmission-web-control</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>docker</tag>
      
      <tag>linuxserver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker配置各种代理</title>
    <link href="/2024/12/09/docker%E9%85%8D%E7%BD%AE%E5%90%84%E7%A7%8D%E4%BB%A3%E7%90%86/"/>
    <url>/2024/12/09/docker%E9%85%8D%E7%BD%AE%E5%90%84%E7%A7%8D%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>参考总结自<a href="https://skywt.cn/blog/">SkyWT</a>的博客<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Docker 代理配置方法合集](https://skywt.cn/blog/docker-proxy-configuration/)">[1]</span></a></sup></p><h2 id="Docker-daemon代理"><a href="#Docker-daemon代理" class="headerlink" title="Docker daemon代理"></a>Docker daemon代理</h2><p><strong>问题</strong>：从DockerHub拉取镜像时可能出现网络问题。</p><p><strong>解决方案</strong>：在 <code>/etc/systemd/system/docker.service.d/http-proxy.conf</code> 编写 systemd 配置，配置 HTTP 和 HTTPS 代理：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Environment</span>=<span class="hljs-string">&quot;HTTP_PROXY=http://127.0.0.1:1080&quot;</span><br><span class="hljs-attr">Environment</span>=<span class="hljs-string">&quot;HTTPS_PROXY=http://127.0.0.1:1080&quot;</span><br></code></pre></td></tr></table></figure><p>配置完之后重新加载配置文件并重启docker：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p>note：不同的发行版中service文件的位置不一样，在archlinux中位于<code>/usr/lib/systemd/system/docker.service</code></p><h3 id="AI的答案"><a href="#AI的答案" class="headerlink" title="AI的答案"></a>AI的答案</h3><p>直接更改系统设置每次更新系统重启之后就会被覆盖，新建一个目录保存配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">mkdir</span> -p /etc/systemd/system/docker.service.d<br></code></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Environment</span>=<span class="hljs-string">&quot;HTTP_PROXY=http://127.0.0.1:7890&quot;</span><br><span class="hljs-attr">Environment</span>=<span class="hljs-string">&quot;HTTPS_PROXY=http://127.0.0.1:7890&quot;</span><br><span class="hljs-attr">Environment</span>=<span class="hljs-string">&quot;NO_PROXY=localhost,127.0.0.1&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl daemon-reexec<br>systemctl daemon-reload<br>systemctl restart docker<br><span class="hljs-comment"># 验证是否有效：</span><br>systemctl show --property=Environment docker<br></code></pre></td></tr></table></figure><h2 id="容器内代理"><a href="#容器内代理" class="headerlink" title="容器内代理"></a>容器内代理</h2><p><strong>问题</strong>：配置每个容器的代理环境变量较繁琐。<br><strong>解决方案</strong>：在 <code>~/.docker/config.json</code> 中设置全局代理配置。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;proxies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;default&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;httpProxy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://example:1080&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;httpsProxy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://example:1080&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;noProxy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*.test.example.com,.example.org,127.0.0.0/8,192.168.0.0/16&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>note：使用sudo启动的容器，配置文件按照<code>/root/.docker/config.json</code>，并且，这里的proxy如果设置为<code>localhost</code>或者<code>127.0.0.1</code>，指的是容器自己的地址。</p><h2 id="Build代理"><a href="#Build代理" class="headerlink" title="Build代理"></a>Build代理</h2><p><strong>问题</strong>：docker build 时网络问题。</p><p><strong>解决方案</strong>：使用<code>docker build</code>时添加参数<code>--network=host</code>设置build网络。或者在<code>docker-compose.yml</code>中设置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">build:</span><br>  <span class="hljs-attr">context:</span> <span class="hljs-string">.</span><br>  <span class="hljs-attr">network:</span> <span class="hljs-string">host</span><br>  <span class="hljs-attr">dockerfile:</span> <span class="hljs-string">Dockerfile</span><br></code></pre></td></tr></table></figure><p>然后在<code>Dockerfile</code>中设定环境变量：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">ENV</span> http_proxy=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br><span class="hljs-keyword">ENV</span> HTTP_PROXY=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br><span class="hljs-keyword">ENV</span> https_proxy=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br><span class="hljs-keyword">ENV</span> HTTPS_PROXY=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br></code></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://skywt.cn/blog/docker-proxy-configuration/">Docker 代理配置方法合集</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.docker.com/blog/what-does-docker-do/">What Does Docker Do? | Docker</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>docker</tag>
      
      <tag>network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用openssl签发ssl证书</title>
    <link href="/2024/12/07/%E4%BD%BF%E7%94%A8openssl%E7%AD%BE%E5%8F%91ssl%E8%AF%81%E4%B9%A6/"/>
    <url>/2024/12/07/%E4%BD%BF%E7%94%A8openssl%E7%AD%BE%E5%8F%91ssl%E8%AF%81%E4%B9%A6/</url>
    
    <content type="html"><![CDATA[<p>如果想给自己的服务用上ssl，需要证书服务，一般都需要购买才行，但是其实主要是信任的问题，所以完全可以用自己的自签名的证书（只要自己想办法确认私钥不会泄露）</p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>openssl生成rsa秘钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl genrsa -out root.rsa.key 2048<br></code></pre></td></tr></table></figure><p>使用秘钥生成证书申请</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl req -new -key root.rsa.key -out root.rsa.csr<br></code></pre></td></tr></table></figure><p>再用生成的秘钥自己给自己签名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl x509 -req -<span class="hljs-keyword">in</span> root.rsa.csr -out root.crt -signkey root.rsa.key -days 365<br></code></pre></td></tr></table></figure><p>如此生成了一个有效期一年的自签名证书。</p><p>如果要在不同的域名（或者IP）上使用ssl，还需要针对每一个主机各自签发证书。步骤类似的</p><blockquote><p>note：按照接下来这几步生成的证书现在浏览器已经不认了，建议直接跳转到后两小节Subject Alternatice Name</p><p>note2：由于安卓手机对安装的CA证书有限制，所以需要在生成root证书时，加上<code>CA:TRUE</code>的扩展字段，生成这类证书的过程参考这里<sup id="fnref:9" class="footnote-ref"><a href="#fn:9" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://foreverzmyer.hashnode.dev/cert">[9]</span></a></sup>。</p></blockquote><p>生成秘钥</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">openssl genrsa -<span class="hljs-keyword">out</span> <span class="hljs-keyword">server</span>.rsa.key <span class="hljs-number">2048</span><br></code></pre></td></tr></table></figure><p>使用秘钥生成证书申请</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl req -new -key server.rsa.key -out server.rsa.csr<br></code></pre></td></tr></table></figure><p>再用刚刚的根证书对这个证书申请签名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl x509 -req -<span class="hljs-keyword">in</span> server.rsa.csr -out server.crt -days 365 -CA root.crt -CAkey root.rsa.key -CAcreateserial -sha256<br></code></pre></td></tr></table></figure><p>如此签发了一个有效期一年的证书。</p><h2 id="but"><a href="#but" class="headerlink" title="but"></a>but</h2><p>但是目前测试在客户端（Edge on Windows11）上试了一下还是会报错，虽然windows已经把root.crt安装到可信的根证书颁发机构。Chrome报错是<code>net::ERR_CERT_COMMON_NAME_INVALID</code></p><h2 id="Subject-Alternative-Name"><a href="#Subject-Alternative-Name" class="headerlink" title="Subject Alternative Name"></a>Subject Alternative Name</h2><p>根据IdeaWand<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[使用OpenSSL生成含有Subject Alternative Name(SAN)的证书 | IdeaWand](https://blog.ideawand.com/2017/11/22/build-certificate-that-support-Subject-Alternative-Name-SAN/)">[7]</span></a></sup>的说法，现在的浏览器基本上都放弃了CommonName。转而使用Subject Alternative Name，所以需要生成带有SAN的证书。</p><p>所以在生成服务器的证书的时候需要指定这些extension。根据zmc<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[OpenSSL证书通过Subject Alternative Name扩展字段扩展证书支持的域名 - 人艰不拆_zmc - 博客园](https://www.cnblogs.com/zhangmingcheng/p/18412749)">[8]</span></a></sup>的教程</p><p>首先生成根证书的过程是不变的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl genrsa -out root.rsa.key 2048<br>openssl req -new -key root.rsa.key -out root.rsa.csr<br>openssl x509 -req -<span class="hljs-keyword">in</span> root.rsa.csr -out root.crt -signkey root.rsa.key -days 365<br></code></pre></td></tr></table></figure><p>然后生成服务器证书的秘钥也是不变的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl genrsa -out server.rsa.key 2048<br></code></pre></td></tr></table></figure><p>然后需要编写配置文件，在配置文件中指定一些extension字段，server.conf</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[ req ]</span><br><span class="hljs-attr">default_bits</span> = <span class="hljs-number">2048</span><br><span class="hljs-attr">prompt</span> = <span class="hljs-literal">no</span><br><span class="hljs-attr">default_md</span> = sha256<br><span class="hljs-attr">req_extensions</span> = v3_ext<br><span class="hljs-attr">distinguished_name</span> = dn<br><br><span class="hljs-section">[ dn ]</span><br><span class="hljs-attr">C</span> = CN<br><span class="hljs-attr">ST</span> = Province Name<br><span class="hljs-attr">L</span> = City<br><span class="hljs-attr">O</span> = Organization Name<br><span class="hljs-attr">OU</span> = Organization Unit Name<br><span class="hljs-attr">CN</span> = Common Name<br><br><span class="hljs-section">[ req_ext ]</span><br><span class="hljs-attr">subjectAltName</span> = @alt_names<br><br><span class="hljs-section">[ alt_names ]</span><br><span class="hljs-attr">DNS.1</span> = DNS name <span class="hljs-number">1</span> <span class="hljs-comment"># 域名</span><br><span class="hljs-attr">DNS.2</span> = DNS name <span class="hljs-number">2</span> <span class="hljs-comment"># 另一个域名</span><br><span class="hljs-attr">IP.1</span> = IP <span class="hljs-number">1</span> <span class="hljs-comment"># IP地址</span><br><span class="hljs-attr">IP.2</span> = IP <span class="hljs-number">2</span> <span class="hljs-comment"># 另一个IP地址</span><br><br><span class="hljs-section">[ v3_ext ]</span><br><span class="hljs-attr">basicConstraints</span>=CA:<span class="hljs-literal">FALSE</span><br><span class="hljs-comment"># keyUsage=keyEncipherment,dataEncipherment</span><br><span class="hljs-comment"># extendedKeyUsage=serverAuth,clientAuth</span><br><span class="hljs-attr">subjectAltName</span>=@alt_names<br></code></pre></td></tr></table></figure><p>注释掉的行大概是一些控制证书的用途的字段，不知道是哪一行导致的不能用于https，所以就都注释掉了。</p><p>然后依赖这个配置文件，生成服务器证书的申请</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl req -new -key server.rsa.key -out server.rsa.csr -config server.conf<br></code></pre></td></tr></table></figure><p>然后使用自签名的根证书，签发服务器证书。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl x509 -req -<span class="hljs-keyword">in</span> server.rsa.csr -out server.crt -days 365 -CA root.crt -CAkey root.rsa.key -CAcreateserial -sha256 -extensions v3_ext -extfile server.conf<br></code></pre></td></tr></table></figure><p>然后得到的<code>server.crt</code>就是有效的证书，然后就<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Apache配置ssl证书-实现https访问 | Galiyy'blog](https://galiyy.github.io/2020/03/31/Apache配置ssl证书-实现https访问/)">[6]</span></a></sup>可以用于https了。</p><p><img src="https://s2.loli.net/2024/12/07/mNcDsAxhnGFkXrI.png" alt="image-20241207215657035"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://gist.github.com/liuguangw/4d4b87b750be8edb700ff94c783b1dd4">使用openssl制作自定义CA、自签名ssl证书</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://ningyu1.github.io/site/post/51-ssl-cert/">Openssl生成自签名证书，简单步骤 - 凝雨 - Yun</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.cnblogs.com/zhaobowen/p/13321578.html">自签名证书和CA证书的区别和制作、使用 - 名字很长容易被惦记 - 博客园</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://breezetemple.github.io/2019/04/08/setup-your-own-CA-with-OpenSSL/">使用 OpenSSL 生成私钥和签名并自己做 CA 签名 |</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://www.tangyuecan.com/2021/12/17/%E5%B1%80%E5%9F%9F%E7%BD%91%E5%86%85%E6%90%AD%E5%BB%BA%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%AF%E4%BF%A1%E4%BB%BB%E7%9A%84ssl%E8%AF%81%E4%B9%A6/">局域网内搭建浏览器可信任的SSL证书 – 唐玥璨 | 博客</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://galiyy.github.io/2020/03/31/Apache%E9%85%8D%E7%BD%AEssl%E8%AF%81%E4%B9%A6-%E5%AE%9E%E7%8E%B0https%E8%AE%BF%E9%97%AE/">Apache配置ssl证书-实现https访问 | Galiyy’blog</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://blog.ideawand.com/2017/11/22/build-certificate-that-support-Subject-Alternative-Name-SAN/">使用OpenSSL生成含有Subject Alternative Name(SAN)的证书 | IdeaWand</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://www.cnblogs.com/zhangmingcheng/p/18412749">OpenSSL证书通过Subject Alternative Name扩展字段扩展证书支持的域名 - 人艰不拆_zmc - 博客园</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:9" class="footnote-text"><span><a href="https://foreverzmyer.hashnode.dev/cert">https://foreverzmyer.hashnode.dev/cert</a><a href="#fnref:9" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>network</tag>
      
      <tag>ssl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《炼金术战争》</title>
    <link href="/2024/12/01/%E3%80%8A%E7%82%BC%E9%87%91%E6%9C%AF%E6%88%98%E4%BA%89%E3%80%8B/"/>
    <url>/2024/12/01/%E3%80%8A%E7%82%BC%E9%87%91%E6%9C%AF%E6%88%98%E4%BA%89%E3%80%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="作者简介"><a href="#作者简介" class="headerlink" title="作者简介"></a>作者简介</h2><p>伊恩·特里吉利斯是一位大胡子江湖医生和某个名誉扫地的塔罗牌预言师的儿子。他还是另一位大胡子乔治·马丁的天才徒弟。<br>他在明尼苏达州出生长大，他的父母为了躲避一位佛兰德亲王的怒火而逃到了那里。（按他的说法，详细的故事还会牵扯到一艘荷兰不定期货船与一匹偷来的马。）如今他和妻子与一只饮食过量的猫住在新墨西哥州，而他在那里与作家、科学家及其他“恶党”为伍。<br>伊恩·特里吉利斯毕业于明尼苏达州州立大学，物理学博士。现就职于美国洛斯阿拉莫斯国家实验室。代表作品：“炼金术战争”系列，“神魔二战”系列。</p><h2 id="机械人"><a href="#机械人" class="headerlink" title="机械人"></a>机械人</h2><p>贾克斯的自由<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="炼金术战争——机械人，Page165">[1]</span></a></sup></p><blockquote><p>自由的感觉……无可比拟。</p><p>自由意志是一片真空，一片负空间。其中没有压力，没有强迫，没有痛苦。是他的意识——此前存在众多禁制，不断争夺其主导权的意识——之中的一片空白。它是照相底片，记录着贾克斯被铸造出来的这118年里的每一分钟的存在。</p><p>它压倒一切。令他兴奋，以及恐惧。</p><p>压倒一切。他能做他想做的任何事。但“任何事都可以”也就代表“没什么特别的事“。自由不会推动他的脚步，也不会为他指引方向。人类是怎么指引自己的？他们怎么知道哪些事该做，哪些不该做？没有禁制和超禁制在争夺生活中每次行动的主导权，他们怎么知道该在何时做些什么？没人告诉他们该做什么，他们又是如何安排每日生活的？</p></blockquote><p>安娜斯塔西亚·贝尔<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="炼金术战争——机械人，Page216">[2]</span></a></sup></p><blockquote><p>“你说我们人类与我们的造物并没有太大分别，这一点没说错。但方向跟你主张的不同。喀拉客并不是另一种拥有灵魂的造物。我们人类也缺少了同样的东西。可悲的事实在于，神父，所谓的灵魂或者自由意志并不存在。二者都只是幻想而已。”</p></blockquote><h2 id="Refreneces"><a href="#Refreneces" class="headerlink" title="Refreneces"></a>Refreneces</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>炼金术战争——机械人，Page165<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>炼金术战争——机械人，Page216<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>通过frida hook ssl函数获取APP流量</title>
    <link href="/2024/09/04/%E9%80%9A%E8%BF%87frida-hook-ssl%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96APP%E6%B5%81%E9%87%8F/"/>
    <url>/2024/09/04/%E9%80%9A%E8%BF%87frida-hook-ssl%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96APP%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<p>通常通过安装证书和设置代理可以mitm并解密所有的流量<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Sniffing TLS traffic on Android | Learning Frida (nibarius.github.io)](https://nibarius.github.io/learning-frida/2022/05/21/sniffing-tls-traffic)">[1]</span></a></sup>。但是有些时候不适宜使用代理，所以还可以通过直接hook ssl的函数来解密流量<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[friTap - 动态解密 TLS ：： lolcads](https://lolcads.github.io/posts/2022/08/fritap/)">[2]</span></a></sup>：</p>    <div class="fold">      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-65ad56e5" role="button" aria-expanded="false" aria-controls="collapse-65ad56e5">        <div class="fold-arrow">▶</div>js code      </div>      <div class="fold-collapse collapse" id="collapse-65ad56e5">        <div class="fold-content">          <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* define global objects.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">var</span> SSL_get_fd, SSL_get_session, SSL_SESSION_get_id, getpeername, getsockname, ntohs, ntohl, addresses;<br><span class="hljs-keyword">var</span> necessary_functions = [<br>    <span class="hljs-string">&quot;SSL_get_fd&quot;</span>,<br>    <span class="hljs-string">&quot;SSL_get_session&quot;</span>,<br>    <span class="hljs-string">&quot;SSL_SESSION_get_id&quot;</span>,<br>    <span class="hljs-string">&quot;getpeername&quot;</span>,<br>    <span class="hljs-string">&quot;getsockname&quot;</span>,<br>    <span class="hljs-string">&quot;ntohs&quot;</span>,<br>    <span class="hljs-string">&quot;ntohl&quot;</span><br>];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] Start the Script.&quot;</span>);<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* Initializes &#x27;addresses&#x27; dictionary and NativeFunctions.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">initializeGlobals</span>(<span class="hljs-params"></span>) &#123;<br>    addresses = &#123;&#125;;<br>    <span class="hljs-keyword">var</span> resolver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiResolver</span>(<span class="hljs-string">&quot;module&quot;</span>);<br>    <span class="hljs-keyword">var</span> exps = [<br>        [<span class="hljs-string">&quot;*libssl*&quot;</span>,<br>            [<span class="hljs-string">&quot;SSL_read&quot;</span>, <span class="hljs-string">&quot;SSL_write&quot;</span>, <span class="hljs-string">&quot;SSL_get_fd&quot;</span>, <span class="hljs-string">&quot;SSL_get_session&quot;</span>,<br>                <span class="hljs-string">&quot;SSL_SESSION_get_id&quot;</span>]],<br>        [<span class="hljs-string">&quot;*libc*&quot;</span>,<br>            [<span class="hljs-string">&quot;getpeername&quot;</span>, <span class="hljs-string">&quot;getsockname&quot;</span>, <span class="hljs-string">&quot;ntohs&quot;</span>, <span class="hljs-string">&quot;ntohl&quot;</span>]]<br>    ];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; exps.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> lib = exps[i][<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">var</span> names = exps[i][<span class="hljs-number">1</span>];<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; names.<span class="hljs-property">length</span>; j++) &#123;<br>            <span class="hljs-keyword">var</span> name = names[j];<br>            <span class="hljs-keyword">var</span> matches = resolver.<span class="hljs-title function_">enumerateMatchesSync</span>(<span class="hljs-string">&quot;exports:&quot;</span> + lib + <span class="hljs-string">&quot;!&quot;</span> +<br>                name);<br>            <span class="hljs-keyword">if</span> (matches.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Could not find &quot;</span> + lib + <span class="hljs-string">&quot;!&quot;</span> + name;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (matches.<span class="hljs-property">length</span> != <span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-comment">// Sometimes Frida returns duplicates.</span><br>                <span class="hljs-keyword">var</span> address = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">var</span> s = <span class="hljs-string">&quot;&quot;</span>;<br>                <span class="hljs-keyword">var</span> duplicates_only = <span class="hljs-literal">true</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>; k &lt; matches.<span class="hljs-property">length</span>; k++) &#123;<br>                    <span class="hljs-keyword">if</span> (s.<span class="hljs-property">length</span> != <span class="hljs-number">0</span>) &#123;<br>                        s += <span class="hljs-string">&quot;, &quot;</span>;<br>                    &#125;<br>                    s += matches[k].<span class="hljs-property">name</span> + <span class="hljs-string">&quot;@&quot;</span> + matches[k].<span class="hljs-property">address</span>;<br>                    <span class="hljs-keyword">if</span> (address == <span class="hljs-number">0</span>) &#123;<br>                        address = matches[k].<span class="hljs-property">address</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!address.<span class="hljs-title function_">equals</span>(matches[k].<span class="hljs-property">address</span>)) &#123;<br>                        duplicates_only = <span class="hljs-literal">false</span>;<br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (!duplicates_only) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;More than one match found for &quot;</span> + lib + <span class="hljs-string">&quot;!&quot;</span> + name + <span class="hljs-string">&quot;: &quot;</span> +<br>                    s;<br>                &#125;<br>            &#125;<br>            addresses[name] = matches[<span class="hljs-number">0</span>].<span class="hljs-property">address</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> index <span class="hljs-keyword">in</span> necessary_functions) &#123;<br>        <span class="hljs-keyword">var</span> key = necessary_functions[index];<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;   * Function: &quot;</span> + key + <span class="hljs-string">&quot;, value: &quot;</span> + addresses[key]);<br>    &#125;<br>    SSL_get_fd = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;SSL_get_fd&quot;</span>], <span class="hljs-string">&quot;int&quot;</span>, [<span class="hljs-string">&quot;pointer&quot;</span>]);<br>    SSL_get_session = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;SSL_get_session&quot;</span>], <span class="hljs-string">&quot;pointer&quot;</span>, [<span class="hljs-string">&quot;pointer&quot;</span>]);<br>    SSL_SESSION_get_id = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;SSL_SESSION_get_id&quot;</span>], <span class="hljs-string">&quot;pointer&quot;</span>, [<span class="hljs-string">&quot;pointer&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>]);<br>    getpeername = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;getpeername&quot;</span>], <span class="hljs-string">&quot;int&quot;</span>, [<span class="hljs-string">&quot;int&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>]);<br>    getsockname = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;getsockname&quot;</span>], <span class="hljs-string">&quot;int&quot;</span>, [<span class="hljs-string">&quot;int&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>]);<br>    ntohs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;ntohs&quot;</span>], <span class="hljs-string">&quot;uint16&quot;</span>, [<span class="hljs-string">&quot;uint16&quot;</span>]);<br>    ntohl = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;ntohl&quot;</span>], <span class="hljs-string">&quot;uint32&quot;</span>, [<span class="hljs-string">&quot;uint32&quot;</span>]);<br>&#125;<br><span class="hljs-title function_">initializeGlobals</span>();<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a dictionary of a sockfd&#x27;s &quot;src_addr&quot;, &quot;src_port&quot;, &quot;dst_addr&quot;, and</span><br><span class="hljs-comment"> * &quot;dst_port&quot;.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">int</span>&#125; sockfd The file descriptor of the socket to inspect.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">boolean</span>&#125; isRead If true, the context is an SSL_read call. If</span><br><span class="hljs-comment"> *     false, the context is an SSL_write call.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">dict</span>&#125; Dictionary of sockfd&#x27;s &quot;src_addr&quot;, &quot;src_port&quot;, &quot;dst_addr&quot;,</span><br><span class="hljs-comment"> *     and &quot;dst_port&quot;.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPortsAndAddresses</span>(<span class="hljs-params">sockfd, isRead</span>) &#123;<br>    <span class="hljs-keyword">var</span> message = &#123;&#125;;<br><br>    <span class="hljs-keyword">var</span> addrlen = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">var</span> addr = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">16</span>);<br><br>    <span class="hljs-keyword">var</span> src_dst = [<span class="hljs-string">&quot;src&quot;</span>, <span class="hljs-string">&quot;dst&quot;</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; src_dst.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">writeU32</span>(addrlen, <span class="hljs-number">16</span>);<br>        <span class="hljs-keyword">if</span> ((src_dst[i] == <span class="hljs-string">&quot;src&quot;</span>) ^ isRead) &#123;<br>            <span class="hljs-title function_">getsockname</span>(sockfd, addr, addrlen);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_">getpeername</span>(sockfd, addr, addrlen);<br>        &#125;<br>        message[src_dst[i] + <span class="hljs-string">&quot;_port&quot;</span>] = <span class="hljs-title function_">ntohs</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU16</span>(addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>)));<br>        message[src_dst[i] + <span class="hljs-string">&quot;_addr&quot;</span>] = <span class="hljs-title function_">ntohl</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU32</span>(addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">4</span>)));<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> message;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Get the session_id of SSL object and return it as a hex string.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">!NativePointer</span>&#125; ssl A pointer to an SSL object.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">dict</span>&#125; A string representing the session_id of the SSL object&#x27;s</span><br><span class="hljs-comment"> *     SSL_SESSION. For example,</span><br><span class="hljs-comment"> *     &quot;59FD71B7B90202F359D89E66AE4E61247954E28431F6C6AC46625D472FF76336&quot;.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getSslSessionId</span>(<span class="hljs-params">ssl</span>) &#123;<br>    <span class="hljs-keyword">var</span> session = <span class="hljs-title function_">SSL_get_session</span>(ssl);<br>    <span class="hljs-keyword">if</span> (session == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">var</span> len = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">var</span> p = <span class="hljs-title function_">SSL_SESSION_get_id</span>(session, len);<br>    len = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU32</span>(len);<br><br>    <span class="hljs-keyword">var</span> session_id = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        <span class="hljs-comment">// Read a byte, convert it to a hex string (0xAB ==&gt; &quot;AB&quot;), and append</span><br>        <span class="hljs-comment">// it to session_id.</span><br>        session_id +=<br>            (<span class="hljs-string">&quot;0&quot;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU8</span>(p.<span class="hljs-title function_">add</span>(i)).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toUpperCase</span>()).<span class="hljs-title function_">substr</span>(-<span class="hljs-number">2</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> session_id;<br>&#125;<br><br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(addresses[<span class="hljs-string">&quot;SSL_read&quot;</span>],<br>    &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-keyword">var</span> message = <span class="hljs-title function_">getPortsAndAddresses</span>(<span class="hljs-title function_">SSL_get_fd</span>(args[<span class="hljs-number">0</span>]), <span class="hljs-literal">true</span>);<br>            message[<span class="hljs-string">&quot;ssl_session_id&quot;</span>] = <span class="hljs-title function_">getSslSessionId</span>(args[<span class="hljs-number">0</span>]);<br>            message[<span class="hljs-string">&quot;function&quot;</span>] = <span class="hljs-string">&quot;SSL_read&quot;</span>;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = message;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">buf</span> = args[<span class="hljs-number">1</span>];<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>            retval |= <span class="hljs-number">0</span>; <span class="hljs-comment">// Cast retval to 32-bit integer.</span><br>            <span class="hljs-keyword">if</span> (retval &lt;= <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-title function_">send</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readByteArray</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">buf</span>, retval));<br>        &#125;<br>    &#125;);<br><br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(addresses[<span class="hljs-string">&quot;SSL_write&quot;</span>],<br>    &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-comment">//var message = &quot;Requests.&quot;</span><br>            <span class="hljs-keyword">var</span> message = <span class="hljs-title function_">getPortsAndAddresses</span>(<span class="hljs-title function_">SSL_get_fd</span>(args[<span class="hljs-number">0</span>]), <span class="hljs-literal">false</span>);<br>            message[<span class="hljs-string">&quot;ssl_session_id&quot;</span>] = <span class="hljs-title function_">getSslSessionId</span>(args[<span class="hljs-number">0</span>]);<br>            message[<span class="hljs-string">&quot;function&quot;</span>] = <span class="hljs-string">&quot;SSL_write&quot;</span>;<br>            <span class="hljs-title function_">send</span>(message, <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readByteArray</span>(args[<span class="hljs-number">1</span>], <span class="hljs-built_in">parseInt</span>(args[<span class="hljs-number">2</span>])));<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123; &#125;<br>    &#125;);<br></code></pre></td></tr></table></figure>        </div>      </div>    </div>    <div class="fold">      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-28ab9646" role="button" aria-expanded="false" aria-controls="collapse-28ab9646">        <div class="fold-arrow">▶</div>python code      </div>      <div class="fold-collapse collapse" id="collapse-28ab9646">        <div class="fold-content">          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> frida<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> datetime<br><br><br>ROOT_DIR = <span class="hljs-string">&quot;&quot;</span><br>SCRIPT = <span class="hljs-string">&quot;&quot;</span><br>APP = <span class="hljs-string">&quot;com.xxx&quot;</span><br><br><br>device = frida.get_usb_device()<br><span class="hljs-comment"># pid = device.spawn(APP) # I don&#x27;t know why this does not work well.</span><br>pid = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> device.enumerate_applications():<br>    <span class="hljs-keyword">if</span> a.identifier == APP:<br>        pid = a.pid  <span class="hljs-comment"># find the process by its&#x27; package name and get its&#x27; pid</span><br>        <span class="hljs-keyword">break</span><br><br>time.sleep(<span class="hljs-number">1</span>)  <span class="hljs-comment"># waitting for something (I don&#x27;t know for what THING, but let&#x27;s wait)</span><br>session = device.attach(pid)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Press Ctrl+C to stop logging.&quot;</span>)<br>fw = <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ROOT_DIR&#125;</span>/log/<span class="hljs-subst">&#123;APP&#125;</span>-<span class="hljs-subst">&#123;datetime.datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d_%H_%M_%S&#x27;</span>)&#125;</span>.log&quot;</span>,<span class="hljs-string">&#x27;w+&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)  <span class="hljs-comment"># file object to write log</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ROOT_DIR&#125;</span>/js_scripts/ssl_hook.js&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    SCRIPT = <span class="hljs-built_in">str</span>(f.read())<br>    <span class="hljs-comment"># print(SCRIPT)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">on_msg</span>(<span class="hljs-params">message, data</span>):<br>    <span class="hljs-keyword">if</span> message[<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;send&quot;</span>:<br>        <span class="hljs-built_in">print</span>(message[<span class="hljs-string">&quot;payload&quot;</span>], data)<br>        fw.write(<span class="hljs-string">&quot;payload: &quot;</span> + <span class="hljs-built_in">str</span>(message[<span class="hljs-string">&quot;payload&quot;</span>]) + <span class="hljs-string">&quot;\n&quot;</span>)<br>        fw.write(<span class="hljs-string">&quot;data: &quot;</span> + <span class="hljs-built_in">str</span>(data) + <span class="hljs-string">&quot;\n&quot;</span>)<br>        fw.flush()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Send type error!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(message, data)<br><br>script = session.create_script(SCRIPT)<br>script.on(<span class="hljs-string">&#x27;message&#x27;</span>, on_msg)<br><br>script.load()<br><br>sys.stdin.read()<br></code></pre></td></tr></table></figure>        </div>      </div>    </div><p>以上代码来自fanxs-t&#x2F;Android-SSL_read-write-Hook<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[fanxs-t/Android-SSL_read-write-Hook: Hook SSL_read and SSL_write functions in the Android application with Frida. (github.com)](https://github.com/fanxs-t/Android-SSL_read-write-Hook)">[3]</span></a></sup>（有一些修改）</p><p>通过ApiResolver获取libssl中的几个关键函数的地址，并hook相应的函数来获取解密后的流量。</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://nibarius.github.io/learning-frida/2022/05/21/sniffing-tls-traffic">Sniffing TLS traffic on Android | Learning Frida (nibarius.github.io)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://lolcads.github.io/posts/2022/08/fritap/">friTap - 动态解密 TLS ：： lolcads</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/fanxs-t/Android-SSL_read-write-Hook">fanxs-t&#x2F;Android-SSL_read-write-Hook: Hook SSL_read and SSL_write functions in the Android application with Frida. (github.com)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>流量分析</tag>
      
      <tag>android</tag>
      
      <tag>frida</tag>
      
      <tag>reverse</tag>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WLAN局域网抓包探索</title>
    <link href="/2024/08/08/WLAN%E5%B1%80%E5%9F%9F%E7%BD%91%E6%8A%93%E5%8C%85%E6%8E%A2%E7%B4%A2/"/>
    <url>/2024/08/08/WLAN%E5%B1%80%E5%9F%9F%E7%BD%91%E6%8A%93%E5%8C%85%E6%8E%A2%E7%B4%A2/</url>
    
    <content type="html"><![CDATA[<p>之前记录过在ubuntu用linux_router来搭建无线网络抓包环境<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[wireshark+ssh输出重定向跨主机抓包 - zr4in](https://zr4in.github.io/2024/05/13/wireshark-ssh输出重定向跨主机抓包/)">[1]</span></a></sup>（ps：这里的无线网络抓包并不是抓802.11空口报文的意思，而是做实验需要获取无线局域网中的所有流量）。大概的网络结构是这样的：</p><p><img src="https://s2.loli.net/2024/08/08/rZBn5dP2jiLSb8F.png" alt="image-20240808153135907"></p><p>Ubuntu上有两张网卡，一张有线eth0一张无线wlan0，其中eth0连接到上游的路由器，而wlan0用来开启hotspot作为无线AP，给其他的无线设备提供Wi-Fi。这样在Ubuntu上直接使用tcpdump，抓取wlan0这张网卡上的所有流量，实际上就相当于在左侧这个网络的第二层（甚至第一层？）上抓包，那么就能抓取整个无线局域网中各个设备之间以及这些设备和外界互联网之间的流量。</p><p>在这种情况下可以抓包，但是却没办法对WLAN中的设备进行更细粒度的管理和操作，比如禁用某个设备和某个外界IP的连接，总之做实验需要这些操作，但是用linux_router做不到。于是决定折腾。以下是弯路：</p><h2 id="x86-64主机安装PVE-openwrt虚拟机"><a href="#x86-64主机安装PVE-openwrt虚拟机" class="headerlink" title="x86_64主机安装PVE+openwrt虚拟机"></a>x86_64主机安装PVE+openwrt虚拟机</h2><p>被学长安利使用PVE安装openwrt虚拟机，然后在实验室发的电脑上安装pve，结果硬件直通的时候，intel的ax201网卡驱动有问题，pve和openwrt都无法识别pcie设备，于是借（白嫖）来了他已经安装好PVE和openwrt的一个工控主机。但是主机上只有4个RJ45接口，没有无线网卡。于是构思了下面的结构：</p><p><img src="https://s2.loli.net/2024/08/08/t1xunsYylq4oM6S.png" alt="image-20240808163053275"></p><p>可以看出来和第一张图几乎是没有区别的（因为根本就是用上面那张图改的），唯一的区别就是openwrt上没有无线网卡，只能把一个小米路由器改成有线中继模式，然后作为一个无线交换机接到openwrt的eth1上，eth1接口上提供dhcp服务，并且作为局域网的网关。</p><p>看上去很完美，但是实际上满足不了前面提到的需求。因为小米的路由器起到了交换机的作用，所以局域网内部设备之间的报文实际上完全没有经过网关，那么在openwrt的eth1上抓包的话，局域网内部的设备之间的流量是完全看不到的，只能抓到广播报文和流出去的报文。第一张图是因为Ubuntu的无线网卡提供了AP，所以可以抓二层的包，但是这张图，只能抓到经过eth1流经openwrt，最终路由到互联网上的报文。</p><p>搞了半天还是在有无线网卡的主机上折腾，这样相当于交换机也是可以抓包的（因为交换机就在主机里面），所以接下来试着折腾在树莓派上装个openwrt。</p><h2 id="树莓派-openwrt"><a href="#树莓派-openwrt" class="headerlink" title="树莓派+openwrt"></a>树莓派+openwrt</h2><p>首先是编译镜像，按照找到的教程<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[树莓派4B安装OpenWrt旁路由并设置相关软件（保姆式教程） - 怕刺 (pa.ci)](https://pa.ci/251.html)">[2]</span></a></sup>上的说法，从某个网站<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[OpenWrt Firmware Selector](https://firmware-selector.openwrt.org/)">[3]</span></a></sup>上编译自定义的固件，先输入使用的型号（<code>Raspberry Pi 4B/400/CM4 (64bit)</code>），右边还可以选择openwrt的版本，默认是最新版（23.05.4），然后展开首次运行的脚本，进行一些定制的设置，点击右下角的齿轮，会自动输入模板，然后把相应设置项的注释符号<code>#</code>删掉，并更改自己想改的设置，比如wifi的ssid和口令，还有root的密码，然后点击请求构建。之后下载FACTORY (EXT4)版本。</p><p><img src="https://s2.loli.net/2024/08/09/XTycYWpCi75mFZk.png" alt="image-20240809112632822"></p><p>下载下来的文件解压后获得img镜像文件，使用烧录镜像的软件（我用的树莓派官方的）烧录进启动的设备（SD卡或者U盘），然后插到树莓派上通电启动。然后就会遇到各种问题了，如下：</p><h3 id="无法启动"><a href="#无法启动" class="headerlink" title="无法启动"></a>无法启动</h3><p>似乎使用u盘作为启动设备会有一点小小的故障，无法启动，查资料应该是有一些bug，感觉是因为固件网站<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[OpenWrt Firmware Selector](https://firmware-selector.openwrt.org/)">[3]</span></a></sup>默认大家是通过SD卡启动的，所以镜像文件里的设置是固定的，总之解决方案在<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[树莓派4B用USB启动OpenWrt固件 · Issue #12 · QuentinHsu/Document-Page · GitHub](https://github.com/QuentinHsu/Document-Page/issues/12)">[7]</span></a></sup>中有提到，更改烧录镜像后的启动设备中的一个文件的内容：</p><blockquote><p>在root分区（应该是打错了，实际上是boot分区）有个cmdline.txt，把<code>root=/dev/mmcblk0p2</code>改成<code>root=/dev/sda2</code>就行了</p></blockquote><p>然后继续，通电启动，按照<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[树莓派4B安装OpenWrt旁路由并设置相关软件（保姆式教程） - 怕刺 (pa.ci)](https://pa.ci/251.html)">[2]</span></a></sup>的说法，实际上这时候应该能找到树莓派的wifi了，但是我自己试下来并没有，刚开始时只能通过命令行访问树莓派，<code>ip addr</code>查看发现只有<code>br-lan</code>这个网桥设备有<code>192.168.1.1</code>这个ip，这个应该是openwrt的子网内部的ip，树莓派还有个<code>eth0</code>的以太网网卡，是没有ip的，试了一下插到自己有网络连接的路由器上，发现<code>eth0</code>刚开始还能自动获取ip，后来干脆ip都没有了。</p><h3 id="没有ip无法进入web后台"><a href="#没有ip无法进入web后台" class="headerlink" title="没有ip无法进入web后台"></a>没有ip无法进入web后台</h3><p>没有wifi，而且有线网卡也不会自动dhcp，通过命令行改<code>eth0</code>的设置也不行，这样就没办法通过openwrt的web后台来配置路由器了。而且通过命令行修改<code>/etc/config/network</code>文件还会发现文件系统是<code>readonly</code>，后来查资料发现可能是某种bug<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[关于树莓派刷写 Openwrt 固件后的一个小疑惑 - V2EX](https://global.v2ex.com/t/798492)">[4]</span></a></sup>，后来按照<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[树莓派软路由openwrt折腾记 - yuaneuro's blog](https://yuaneu.ro/archives/openwrt.html)">[5]</span></a></sup>中的说法应该是意外断电导致的（确实在安装的时候我自己手动断电过好几次，因为实在不知道怎么操作），<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[树莓派软路由openwrt折腾记 - yuaneuro's blog](https://yuaneu.ro/archives/openwrt.html)">[5]</span></a></sup><sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Read only root filesystem - Installing and Using OpenWrt - OpenWrt Forum](https://forum.openwrt.org/t/read-only-root-filesystem/111913)">[6]</span></a></sup>给出的解决方案有：<code>e2fsck -y /dev/[your device]</code>然后<code>reboot</code>重启就可以了，注意<code>[your device]</code>换成你用的启动设备，我的是<code>sda2</code>（和前面解决无法启动的bug时是对应的，也就是启动的操作系统分区）。</p><p>总之后来的解决办法是，把树莓派的以太网口和自己的电脑的以太网口连到一起，有些教程说自己电脑设置dhcp就可以，我试了一下好像不行</p><p><img src="https://s2.loli.net/2024/08/09/qZBAHWrl2mY3hPn.png" alt="image-20240809162335323"></p><p>总之手动设置ip肯定也是可以的，设置自己的电脑的ip为<code>192.168.1.2</code>（应该不和openwrt的<code>192.168.1.1</code>重复就行）</p><p><img src="https://s2.loli.net/2024/08/09/dmcirCuSftJXj6v.png" alt="image-20240809162509846"></p><p>然后通过浏览器访问<code>http://192.168.1.1</code>也就是openwrt的管理后台，在这里更改openwrt的设置。</p><p><img src="https://s2.loli.net/2024/08/09/ea7hCI2jVW5diPM.png" alt="image-20240809162609248"></p><p>第一件事，先把防火墙关了（也不是关了，反正配置宽松一点），openwrt默认只能通过lan访问后台进行配置，先把wan口配置的防火墙规则打开，这样就可以直接在子网之外就能通过web后台来配置路由器了。总之全都改成accept，然后save &amp; apply：</p><p><img src="https://s2.loli.net/2024/08/09/H6WFw7PlzecGhrB.png" alt="image-20240809162912603"></p><h3 id="添加wan口"><a href="#添加wan口" class="headerlink" title="添加wan口"></a>添加wan口</h3><p>进入后台之后，为了方便以后的配置，在导航栏network-&gt;interfaces下添加一个网络接口，也就是添加一个wan口。设置wan口为dhcp client。</p><p><img src="https://s2.loli.net/2024/08/09/dDc5ReQf6ECapH8.png" alt="image-20240809163355654"></p><p>然后进到network-&gt;wireless，把wifi打开一下，下图是已经enable了的情况：</p><p><img src="https://s2.loli.net/2024/08/09/2FqA8fBWTp3SPig.png" alt="image-20240809164614181"></p><p>然后把原来的br-lan这个interface改一下（因为这个interface也用了eth0这个物理设备，会出现冲突，改到无线网络接口上，选中wireless设备就行）：</p><p><img src="https://s2.loli.net/2024/08/09/cROwWQCahqSkLvF.png" alt="image-20240809164743052"></p><p>然后save apply，执行之后实际上目前这个浏览器的窗口就不会有响应了，因为现在网络拓扑已经变化了，这时候可以把树莓派上的网线接到上游的路由器了。注意这里尽快把网线换到路由器上，忘记在哪看到的资料说多少秒内如果没有按照现有的配置成功完成设置，openwrt会自动reset回上次的设置，save and apply的时候有一个弹窗显示的时间应该就是timeout。由上层的路由器dhcp分配给它一个ip，可以通过这个ip来访问后台：</p><p><img src="https://s2.loli.net/2024/08/09/za4BNndLCJgKhRO.png" alt="image-20240809165240360"></p><h3 id="web后台更改设置无法生效"><a href="#web后台更改设置无法生效" class="headerlink" title="web后台更改设置无法生效"></a>web后台更改设置无法生效</h3><p>如果在web后台更改设置，然后点击apply，然后刷新页面发现实际上并没有apply成功，那有可能是因为<code>readonly</code>的文件系统导致的，按照前面说的，运行<code>e2fsck -y /dev/[your device]</code>然后<code>reboot</code>重启就可以了。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>执行完上面的过程之后，树莓派已经变成一个合格的无线路由器了，然后就是其他的更改了。</p><h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>树莓派4B安装openwrt似乎存在2.4G频段的AP无法使用的情况，经过上述的配置之后，可以在5G频段以AP模式工作，但是无法在2.4G频段下以AP模式工作<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[2.4 GHz radio doesn't work on Raspberry Pi 4B · Issue #9600 · openwrt/openwrt · GitHub](https://github.com/openwrt/openwrt/issues/9600)">[8]</span></a></sup>，会出现各种各样的报错。</p><p>然后根据这个issue中的讨论，这个问题很早之前就存在了，然后inconnu299<sup id="fnref:9" class="footnote-ref"><a href="#fn:9" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://github.com/openwrt/openwrt/issues/9600#issuecomment-1279742554">[9]</span></a></sup>的回复是有效的，更改后我的<code>/etc/config/wireless</code>内容如下：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">config wifi-device <span class="hljs-string">&#x27;radio0&#x27;</span><br>        <span class="hljs-keyword">option</span> <span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;mac80211&#x27;</span><br>        <span class="hljs-keyword">option</span> <span class="hljs-type">path</span> <span class="hljs-string">&#x27;platform/soc/fe300000.mmcnr/mmc_host/mmc1/mmc1:0001/mmc1:0001:1&#x27;</span><br>        <span class="hljs-keyword">option</span> channel <span class="hljs-string">&#x27;1&#x27;</span><br>        <span class="hljs-keyword">option</span> band <span class="hljs-string">&#x27;2g&#x27;</span><br>        <span class="hljs-keyword">option</span> disabled <span class="hljs-string">&#x27;0&#x27;</span><br>        <span class="hljs-keyword">option</span> short_gi_40 <span class="hljs-string">&#x27;0&#x27;</span><br>        <span class="hljs-keyword">option</span> htmode <span class="hljs-string">&#x27;HT40&#x27;</span><br>        <span class="hljs-keyword">option</span> cell_density <span class="hljs-string">&#x27;0&#x27;</span><br>#       <span class="hljs-keyword">option</span> legacy_rates <span class="hljs-string">&#x27;1&#x27;</span><br><br>config wifi-iface <span class="hljs-string">&#x27;wifinet0&#x27;</span><br>        <span class="hljs-keyword">option</span> device <span class="hljs-string">&#x27;radio0&#x27;</span><br>        <span class="hljs-keyword">option</span> mode <span class="hljs-string">&#x27;ap&#x27;</span><br>        <span class="hljs-keyword">option</span> ssid <span class="hljs-string">&#x27;your_ssid&#x27;</span><br>        <span class="hljs-keyword">option</span> encryption <span class="hljs-string">&#x27;psk2&#x27;</span><br>        <span class="hljs-keyword">option</span> key <span class="hljs-string">&#x27;your_wifi_password&#x27;</span><br>        <span class="hljs-keyword">option</span> network <span class="hljs-string">&#x27;lan&#x27;</span><br></code></pre></td></tr></table></figure><p>配置之后重启，然后就可以了。</p><p>。</p><p>暂时更到这里。一些可能有用的链接<sup id="fnref:10" class="footnote-ref"><a href="#fn:10" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Wireless AP on Raspberry Pi 4B not working - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum](https://forum.openwrt.org/t/wireless-ap-on-raspberry-pi-4b-not-working/94875)">[10]</span></a></sup><sup id="fnref:11" class="footnote-ref"><a href="#fn:11" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Wireless is not Associated - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum](https://forum.openwrt.org/t/wireless-is-not-associated/63291/36)">[11]</span></a></sup><sup id="fnref:12" class="footnote-ref"><a href="#fn:12" rel="footnote"><span class="hint--top hint--rounded" aria-label="[树莓派 4B OpenWrt 旁路由教程 | 叶寻的博客 (cyrusyip.org)](https://cyrusyip.org/zh-cn/posts/2021/08/30/raspberry-pi-4b-openwrt/)">[12]</span></a></sup><sup id="fnref:13" class="footnote-ref"><a href="#fn:13" rel="footnote"><span class="hint--top hint--rounded" aria-label="[nftables 入门：从配置文件到端口转发 | Rachel's Blog | Rachel030219 (rachelt.one)](https://blog.rachelt.one/articles/new-to-nftables-from-config-to-dnat/)">[13]</span></a></sup></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zr4in.github.io/2024/05/13/wireshark-ssh%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%A8%E4%B8%BB%E6%9C%BA%E6%8A%93%E5%8C%85/">wireshark+ssh输出重定向跨主机抓包 - zr4in</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://pa.ci/251.html">树莓派4B安装OpenWrt旁路由并设置相关软件（保姆式教程） - 怕刺 (pa.ci)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://firmware-selector.openwrt.org/">OpenWrt Firmware Selector</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://global.v2ex.com/t/798492">关于树莓派刷写 Openwrt 固件后的一个小疑惑 - V2EX</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://yuaneu.ro/archives/openwrt.html">树莓派软路由openwrt折腾记 - yuaneuro’s blog</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://forum.openwrt.org/t/read-only-root-filesystem/111913">Read only root filesystem - Installing and Using OpenWrt - OpenWrt Forum</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://github.com/QuentinHsu/Document-Page/issues/12">树莓派4B用USB启动OpenWrt固件 · Issue #12 · QuentinHsu&#x2F;Document-Page · GitHub</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://github.com/openwrt/openwrt/issues/9600">2.4 GHz radio doesn’t work on Raspberry Pi 4B · Issue #9600 · openwrt&#x2F;openwrt · GitHub</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:9" class="footnote-text"><span><a href="https://github.com/openwrt/openwrt/issues/9600#issuecomment-1279742554">https://github.com/openwrt/openwrt/issues/9600#issuecomment-1279742554</a><a href="#fnref:9" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:10" class="footnote-text"><span><a href="https://forum.openwrt.org/t/wireless-ap-on-raspberry-pi-4b-not-working/94875">Wireless AP on Raspberry Pi 4B not working - Installing and Using OpenWrt &#x2F; Network and Wireless Configuration - OpenWrt Forum</a><a href="#fnref:10" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:11" class="footnote-text"><span><a href="https://forum.openwrt.org/t/wireless-is-not-associated/63291/36">Wireless is not Associated - Installing and Using OpenWrt &#x2F; Network and Wireless Configuration - OpenWrt Forum</a><a href="#fnref:11" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:12" class="footnote-text"><span><a href="https://cyrusyip.org/zh-cn/posts/2021/08/30/raspberry-pi-4b-openwrt/">树莓派 4B OpenWrt 旁路由教程 | 叶寻的博客 (cyrusyip.org)</a><a href="#fnref:12" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:13" class="footnote-text"><span><a href="https://blog.rachelt.one/articles/new-to-nftables-from-config-to-dnat/">nftables 入门：从配置文件到端口转发 | Rachel’s Blog | Rachel030219 (rachelt.one)</a><a href="#fnref:13" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>openwrt</tag>
      
      <tag>流量分析</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>通过ssh隧道使用代理</title>
    <link href="/2024/07/11/%E9%80%9A%E8%BF%87ssh%E9%9A%A7%E9%81%93%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86/"/>
    <url>/2024/07/11/%E9%80%9A%E8%BF%87ssh%E9%9A%A7%E9%81%93%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>实验室发的电脑性能太过孱弱了，就被我放在那当成24小时开机的个人服务器来用了，主要是做一些实验和作为sftp服务器，然后就在想，既然可以通过ssh隧道，作为文件服务器（其实是不是ftp over ssh这里先不深究），那么能不能通过ssh作为代理转发所有的流量呢？今天搜了一下果然有，先摆两个链接在这里<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[How to use SSH as a secure Proxy (networklessons.com)](https://networklessons.com/uncategorized/how-to-use-ssh-as-a-secure-proxy)">[1]</span></a></sup><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[SSH Tunneling and Proxying | Baeldung on Linux](https://www.baeldung.com/linux/ssh-tunneling-and-proxying)">[2]</span></a></sup>。</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://networklessons.com/uncategorized/how-to-use-ssh-as-a-secure-proxy">How to use SSH as a secure Proxy (networklessons.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.baeldung.com/linux/ssh-tunneling-and-proxying">SSH Tunneling and Proxying | Baeldung on Linux</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>M</title>
    <link href="/2024/07/10/M/"/>
    <url>/2024/07/10/M/</url>
    
    <content type="html"><![CDATA[<h2 id="Man-in-the-mirror"><a href="#Man-in-the-mirror" class="headerlink" title="Man in the mirror"></a>Man in the mirror</h2><blockquote><p>If you wanna make the world</p><p>A better place</p><p>Take a look at yourself</p><p>And then make that change</p></blockquote><h2 id="无名的人"><a href="#无名的人" class="headerlink" title="无名的人"></a>无名的人</h2><blockquote><p>你来自于 南方的村落 来自粗糙的双手</p><p>你站在 楼宇的缝隙 可你没有退缩</p><p>我来自于 北方的春天 来自一步一回首</p><p>背后有 告别的路口 温暖每个日落</p><p>当家乡入冬 的时候</p><p>列车到站 以后</p><p>小时候的风 再吹过</p><p>回忆起单纯 的快乐</p><p>在熟悉的 街头</p><p>有人 会用所有的温柔 喊出你的</p><p>名字</p></blockquote><h2 id="Life-Will-Change"><a href="#Life-Will-Change" class="headerlink" title="Life Will Change"></a>Life Will Change</h2><blockquote><p>And you’ll know we were out there</p><p>Swatted lies in the making</p><p>Your empire for the taking</p><p>Can’t hold on or life won’t change</p><p>And our voices rang out here</p><p>Took the mask off to feel free</p><p>Fought it out in the debris</p><p>Now we know that life will change</p></blockquote><h2 id="我不知道"><a href="#我不知道" class="headerlink" title="我不知道"></a>我不知道</h2><blockquote><p>星星和月亮一起闪耀</p><p>驱散了孤独和寂寥</p><p>洒向黑暗的每一秒</p><p>也会把你照耀</p><p>受伤的孩子不再哭闹</p><p>疲惫的人不再奔跑</p><p>又看到你开心地笑</p><p>仿佛什么 什么 都不知道</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wireshark+ssh输出重定向跨主机抓包</title>
    <link href="/2024/05/13/wireshark-ssh%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%A8%E4%B8%BB%E6%9C%BA%E6%8A%93%E5%8C%85/"/>
    <url>/2024/05/13/wireshark-ssh%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%A8%E4%B8%BB%E6%9C%BA%E6%8A%93%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<p>适用于linux主机作为热点网络AP，然后给其他设备提供网络连接，那么所有的流量都经过linux主机转发，也就方便了流量分析。然后如果希望在另一台主机（windows）上看到实时的抓包情况，可以通过ssh连接到linux，ssh命令的输出重定向到windows的wireshark中。</p><p>linux上运行create_ap<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[oblique/create_ap: \[NOT MAINTAINED\] This script creates a NATed or Bridged WiFi Access Point. (github.com)](https://github.com/oblique/create_ap)">[1]</span></a></sup>或者linux-wifi-hotspot<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[lakinduakash/linux-wifi-hotspot: Feature-rich wifi hotspot creator for Linux which provides both GUI and command-line interface. It is also able to create a hotspot using the same wifi card which is connected to an AP already ( Similar to Windows 10). (github.com)](https://github.com/lakinduakash/linux-wifi-hotspot)">[2]</span></a></sup>或者linux_router<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[garywill/linux-router: Set Linux as router in one command. Support Internet sharing, redsocks, Wifi hotspot, IPv6. Can also be used for routing VM/containers 🛰️ (也欢迎关注B站 https://space.bilibili.com/2123686105 ) (github.com)](https://github.com/garywill/linux-router)">[3]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">linux_router<br></code></pre></td></tr></table></figure><p>注意如果windows上没有wireshark添加到环境变量的话需要添加换进变量或者使用wireshark的绝对路径。而且要用cmd不能用powershell，似乎是因为powershell的管道重定向不太一样<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[使用 tcpdump 和 Wireshark 进行远程实时抓包分析 - This Cute World](https://thiscute.world/posts/tcpdump-and-wireshark/)">[4]</span></a></sup>。</p><p>windows上运行ssh+wireshark</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ssh username@host &quot;sudo tcpdump -i wlo1 -l -w -&quot; | wireshark -k -i -<br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/oblique/create_ap">oblique&#x2F;create_ap: [NOT MAINTAINED] This script creates a NATed or Bridged WiFi Access Point. (github.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/lakinduakash/linux-wifi-hotspot">lakinduakash&#x2F;linux-wifi-hotspot: Feature-rich wifi hotspot creator for Linux which provides both GUI and command-line interface. It is also able to create a hotspot using the same wifi card which is connected to an AP already ( Similar to Windows 10). (github.com)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/garywill/linux-router">garywill&#x2F;linux-router: Set Linux as router in one command. Support Internet sharing, redsocks, Wifi hotspot, IPv6. Can also be used for routing VM&#x2F;containers 🛰️ (也欢迎关注B站 https://space.bilibili.com/2123686105 ) (github.com)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://thiscute.world/posts/tcpdump-and-wireshark/">使用 tcpdump 和 Wireshark 进行远程实时抓包分析 - This Cute World</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>流量分析</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>无线网卡混杂模式wifi抓包</title>
    <link href="/2024/04/24/%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8Fwifi%E6%8A%93%E5%8C%85/"/>
    <url>/2024/04/24/%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8Fwifi%E6%8A%93%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<p>现在的IoT设备往往依赖于蓝牙、zigbee或者wifi等无线通信介质，为了更清晰地了解设备的通信，有必要学习一下wifi抓包。</p><h2 id="Airomon-ng"><a href="#Airomon-ng" class="headerlink" title="Airomon-ng"></a>Airomon-ng</h2><p>试过用<code>iwconfig</code>直接设置网卡为<code>Monitor</code>模式，然后直接用wireshark抓包，是不行的，应该还有其他设置，就不管了，还是用现成的工具吧<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux环境下Wi-Fi抓包说明 - Nordic Semiconductor中文官网](https://www.nordicsemi.cn/news/linux-environment-wifi-packet-capture-instructions/)">[1]</span></a></sup></p><p><code>airmon-ng</code>先设置网卡为监听模式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo airmon-ng start wlo1<br></code></pre></td></tr></table></figure><p>注意如果输出提示有其他进程可能会影响抓包，就按照提示执行对应命令kill掉其他进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo airmon-ng check <span class="hljs-built_in">kill</span><br></code></pre></td></tr></table></figure><h2 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">airodump-ng -c 6 --bssid mac_address_of_ap wlo1mon --output-format pcap -w file_to_write<br></code></pre></td></tr></table></figure><p><code>-c 6</code>指定了第6个信道，<code>--bssid</code>指定要抓取的ap的mac地址，然后是开启抓包模式的网卡的名称<code>wlo1mon</code>，然后<code>-w</code>指定要把抓取的报文写到哪个文件。</p><h2 id="解密wifi报文"><a href="#解密wifi报文" class="headerlink" title="解密wifi报文"></a>解密wifi报文</h2><p>在知道wifi密码并且抓到设备握手的报文之后，可以解密已加密的wifi报文<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[用Wireshark解密无线网络数据包 | F1v3's Notes (x-f1v3.github.io)](https://x-f1v3.github.io/blog/用Wireshark解密无线网络数据包.html)">[2]</span></a></sup>，有时候需要删除wireshark的配置文件避免出现bug<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[解密 802.11 加密数据包 | (breezetemple.github.io)](https://breezetemple.github.io/2019/05/31/decryption-802-11-with-wireshark/)">[3]</span></a></sup></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.nordicsemi.cn/news/linux-environment-wifi-packet-capture-instructions/">Linux环境下Wi-Fi抓包说明 - Nordic Semiconductor中文官网</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://x-f1v3.github.io/blog/%E7%94%A8Wireshark%E8%A7%A3%E5%AF%86%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%8C%85.html">用Wireshark解密无线网络数据包 | F1v3’s Notes (x-f1v3.github.io)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://breezetemple.github.io/2019/05/31/decryption-802-11-with-wireshark/">解密 802.11 加密数据包 | (breezetemple.github.io)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>流量分析</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows右键菜单新建markdown文档</title>
    <link href="/2024/04/23/windows%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BAmarkdown%E6%96%87%E6%A1%A3/"/>
    <url>/2024/04/23/windows%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BAmarkdown%E6%96%87%E6%A1%A3/</url>
    
    <content type="html"><![CDATA[<p>typora的官网上有相应的教程<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Add New “Markdown” Item in Context Menu - Typora Support](https://support.typora.io/New-File-in-Context/)">[1]</span></a></sup>，就是更改windows的注册表，这样可以直接右键新建markdown文件，就不用朴素地新建txt文件然后再改后缀了，typora给出的注册表是：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs csharp">Windows Registry Editor Version <span class="hljs-number">5.00</span><br><br>[<span class="hljs-meta">HKEY_CLASSES_ROOT\.md</span>]<br>@=<span class="hljs-string">&quot;markdown&quot;</span><br><br>[<span class="hljs-meta">HKEY_CLASSES_ROOT\.md\ShellNew</span>]<br><span class="hljs-string">&quot;NullFile&quot;</span>=<span class="hljs-string">&quot;&quot;</span><br><br>[<span class="hljs-meta">HKEY_CLASSES_ROOT\markdown</span>]<br>@=<span class="hljs-string">&quot;Blank Markdown file&quot;</span><br></code></pre></td></tr></table></figure><p>可以先新建txt，然后复制进去，再改后缀为reg，然后双击运行，这样右键的新建菜单会有”Blank Markdown file”选项（个人感觉把Blank直接去掉更优雅）</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://support.typora.io/New-File-in-Context/">Add New “Markdown” Item in Context Menu - Typora Support</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>mix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记Android某APP逆向</title>
    <link href="/2024/04/16/%E8%AE%B0Android%E6%9F%90APP%E9%80%86%E5%90%91/"/>
    <url>/2024/04/16/%E8%AE%B0Android%E6%9F%90APP%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<p>记录一下自己探索安卓逆向的过程，纯新手脚本小子，如有谬误恳请各位斧正。</p><h2 id="root"><a href="#root" class="headerlink" title="root"></a>root</h2><p>首先是获取手机的root权限，比较简单的方法是模拟器，一般都会直接开放root，但是有些app可能会有虚拟机检测，没有的话最好，有的话可能需要花心思考虑绕过，或者使用真机。</p><p>使用真机一般会好很多。真机root一般会用到magisk<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[topjohnwu/Magisk: The Magic Mask for Android (github.com)](https://github.com/topjohnwu/Magisk)">[1]</span></a></sup>，然后也需要对应手机型号的镜像文件（所以一般需要厂商支持root，比如小米的手机和google的pixel），这篇blog就先不讲怎么root的了，教程其实很多。</p><h2 id="Frida"><a href="#Frida" class="headerlink" title="Frida"></a>Frida</h2><p>然后是Frida<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[frida/frida: Clone this repo to build Frida (github.com)](https://github.com/frida/frida)">[2]</span></a></sup>，Frida是一个python + js的hook框架<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Frida 原理及简单使用 - Only-xiaoxiao - 博客园 (cnblogs.com)](https://www.cnblogs.com/Only-xiaoxiao/p/17294561.html)">[3]</span></a></sup>，本质上是一种动态插桩工具。使用的时候，在需要hook的地方，比如Android手机上以root权限运行对应架构（x86或者arm，虚拟机一般x86，真机一般arm）的frida-server，然后在进行hook的地方运行frida或者frida-tools工具，frida和frida-tools并不是同一个东西，我暂时没有专门去搞清楚这两者的联系，但是需要注意的是两者需要版本兼容<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Frida server 和 python client下载 版本对应关系 - 悟透 - 博客园 (cnblogs.com)](https://www.cnblogs.com/wutou/p/17884865.html)">[4]</span></a></sup>。一般直接安装最新版应该就可以：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">pip install frida<br>pip install frida-tools<br></code></pre></td></tr></table></figure><h2 id="jadx"><a href="#jadx" class="headerlink" title="jadx"></a>jadx</h2><p>jadx<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[skylot/jadx: Dex to Java decompiler (github.com)](https://github.com/skylot/jadx)">[5]</span></a></sup>是一个开源安卓逆向工具，主要用于逆向分析apk，反编译为java源代码（当然一般不可能完美反编译，遇到过一些报错的地方）</p><p>如果apk没有加壳的话，直接把apk拖到jadx里就行，jadx会自动完成分析，比如这样：</p><p><img src="https://s2.loli.net/2024/04/23/MxLacvCR19o6myg.png" alt="image-20240423095710623"></p><p>如果代码是混淆过的，那可能会比较难过，只能慢慢看了，或许程序分析领域会有针对反混淆的研究，但是个人感觉可能都是比较ad-hoc的，而且其实混淆不是很严重的话，根据log或者一些字符串来进行推测，应该也是能分析的，我目前还没有用什么反混淆的工具，jadx自带反混淆工具，但也只是把一些函数名或者类名中的不常见的字符给去掉，换成一些常见字符加上数字编号。</p><h2 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h2><p>hook通俗点就是钩子（<del>沟子</del>）（<del>坏，沟子文学逐渐污染互联网</del>），把正常的实现替换为自己想要的实现，比如app中某个函数想要检测环境然后返回true或者false，然后你希望它永远返回true，就可以利用hook</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> java_class = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.app.classname&quot;</span>);<br>    <br>    java_class.<span class="hljs-property">function_name</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&quot;para list&quot;</span>).<span class="hljs-property">implemeation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-string">&quot;para list&quot;</span></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure><p>然后使用frida的命令行工具将代码注入到对应的app进程就可以了<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[frida的用法--Hook Java代码篇 - luoyesiqiu - 博客园 (cnblogs.com)](https://www.cnblogs.com/luoyesiqiu/p/10718997.html)">[6]</span></a></sup></p><h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><p>以运动健康app为例，比如希望知道它所有的加密操作（代码忘记从哪复制来的了，如有问题请联系我）：</p>    <div class="fold">      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-e064c6af" role="button" aria-expanded="false" aria-controls="collapse-e064c6af">        <div class="fold-arrow">▶</div>js code      </div>      <div class="fold-collapse collapse" id="collapse-e064c6af">        <div class="fold-content">          <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">showStacks</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">send</span>(<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;android.util.Log&quot;</span>).<span class="hljs-title function_">getStackTraceString</span>(<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;java.lang.Exception&quot;</span>).$new()));<br>    &#125;);<br>&#125;; <span class="hljs-comment">// print stack info</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bytesToHex</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">var</span> str = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> tmp = arr[i];<br>        <span class="hljs-keyword">if</span> (tmp &lt; <span class="hljs-number">0</span>) &#123;<br>            tmp = (<span class="hljs-number">255</span> + tmp + <span class="hljs-number">1</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            tmp = tmp.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (tmp.<span class="hljs-property">length</span> == <span class="hljs-number">1</span>) &#123;<br>            tmp = <span class="hljs-string">&quot;0&quot;</span> + tmp;<br>        &#125;<br>        str += tmp;<br>    &#125;<br>    <span class="hljs-keyword">return</span> str;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bytesToBase64</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> base64EncodeChars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>;<br>    <span class="hljs-keyword">var</span> r, a, c, h, o, t;<br>    <span class="hljs-keyword">for</span> (c = e.<span class="hljs-property">length</span>, a = <span class="hljs-number">0</span>, r = <span class="hljs-string">&#x27;&#x27;</span>; a &lt; c;) &#123;<br>        <span class="hljs-keyword">if</span> (h = <span class="hljs-number">255</span> &amp; e[a++], a == c) &#123;<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(h &gt;&gt; <span class="hljs-number">2</span>),<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">3</span> &amp; h) &lt;&lt; <span class="hljs-number">4</span>),<br>            r += <span class="hljs-string">&#x27;==&#x27;</span>;<br>            <span class="hljs-keyword">break</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (o = e[a++], a == c) &#123;<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(h &gt;&gt; <span class="hljs-number">2</span>),<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">3</span> &amp; h) &lt;&lt; <span class="hljs-number">4</span> | (<span class="hljs-number">240</span> &amp; o) &gt;&gt; <span class="hljs-number">4</span>),<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">15</span> &amp; o) &lt;&lt; <span class="hljs-number">2</span>),<br>            r += <span class="hljs-string">&#x27;=&#x27;</span>;<br>            <span class="hljs-keyword">break</span><br>        &#125;<br>        t = e[a++],<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(h &gt;&gt; <span class="hljs-number">2</span>),<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">3</span> &amp; h) &lt;&lt; <span class="hljs-number">4</span> | (<span class="hljs-number">240</span> &amp; o) &gt;&gt; <span class="hljs-number">4</span>),<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">15</span> &amp; o) &lt;&lt; <span class="hljs-number">2</span> | (<span class="hljs-number">192</span> &amp; t) &gt;&gt; <span class="hljs-number">6</span>),<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">63</span> &amp; t)<br>    &#125;<br>    <span class="hljs-keyword">return</span> r<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bytesToString</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> arr === <span class="hljs-string">&#x27;string&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> arr;<br>    &#125;<br>    <span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;&#x27;</span>,<br>    _arr = arr;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; _arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> one = _arr[i].<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>),<br>        v = one.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^1+?(?=0)/</span>);<br>        <span class="hljs-keyword">if</span> (v &amp;&amp; one.<span class="hljs-property">length</span> == <span class="hljs-number">8</span>) &#123;<br>            <span class="hljs-keyword">var</span> bytesLength = v[<span class="hljs-number">0</span>].<span class="hljs-property">length</span>;<br>            <span class="hljs-keyword">var</span> store = _arr[i].<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">7</span> - bytesLength);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> st = <span class="hljs-number">1</span>; st &lt; bytesLength; st++) &#123;<br>                store += _arr[st + i].<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>);<br>            &#125;<br>            str += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-built_in">parseInt</span>(store, <span class="hljs-number">2</span>));<br>            i += bytesLength - <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            str += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(_arr[i]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> str;<br>&#125;<br><br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> secretKeySpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.spec.SecretKeySpec&#x27;</span>);<br>    secretKeySpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a, b);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.spec.SecretKeySpec.$init(byte[], String)</span><br><span class="hljs-string">算法名                  : <span class="hljs-subst">$&#123; b &#125;</span></span><br><span class="hljs-string">Dec密钥(String)         : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">Dec秘钥(Hex)            : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> mac = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.Mac&#x27;</span>);<br>    mac.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.getInstance(String)</span><br><span class="hljs-string">算法名                  : <span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    mac.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.update(byte[])</span><br><span class="hljs-string">Mac update(string)      : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">Mac update(hex)         : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a);<br>    &#125;;<br>    mac.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b,c</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.update(byte[], int, int)</span><br><span class="hljs-string">Mac update(string)      : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">Mac update(hex)         : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a, b, c)<br>    &#125;;<br>    mac.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>().<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>();<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.doFinal()</span><br><span class="hljs-string">doFinal结果(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    mac.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.doFinal(byte[])</span><br><span class="hljs-string">doFinal参数(string)     : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">doFinal参数(hex)        : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">---</span><br><span class="hljs-string">doFinal结果(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> md = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.security.MessageDigest&#x27;</span>);<br>    md.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>,<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.getInstance(String, String)</span><br><span class="hljs-string">算法名                  ：<span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">参数2                   ：<span class="hljs-subst">$&#123; b &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a, b);<br>    &#125;;<br>    md.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.getInstance(String)</span><br><span class="hljs-string">算法名                  ：<span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a);<br>    &#125;;<br>    md.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.update(byte[])</span><br><span class="hljs-string">MessageDigest update(string)    : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">MessageDigest update(hex)       : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a);<br>    &#125;;<br>    md.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b,c</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.update(byte[], int, int)</span><br><span class="hljs-string">MessageDigest update(string)    : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">MessageDigest update(hex)       : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a,b,c);<br>    &#125;;<br>    md.<span class="hljs-property">digest</span>.<span class="hljs-title function_">overload</span>().<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">digest</span>();<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.digest()</span><br><span class="hljs-string">digest结果(string)      : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">digest结果(hex)         : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    md.<span class="hljs-property">digest</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">digest</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.digest(byte[])</span><br><span class="hljs-string">digest参数(string)      : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">digest参数(hex   )      : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">---</span><br><span class="hljs-string">digest结果(string)      : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">digest结果(hex)         : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">digest结果(base64)      : <span class="hljs-subst">$&#123; bytesToBase64(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> ivParameterSpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.spec.IvParameterSpec&#x27;</span>);<br>    ivParameterSpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>       <span class="hljs-comment">// showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.spec.IvParameterSpec.$init(byte[])</span><br><span class="hljs-string">iv向量(string)          : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">iv向量(hex)             : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> cipher = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.Cipher&#x27;</span>);<br>    cipher.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.getInstance(String)</span><br><span class="hljs-string">模式填充                : <span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.update(byte[])\n&quot; +</span><br><span class="hljs-string">Cipher update(string)   : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">Cipher update(hex)      : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b,c</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.update(byte[], int, int)</span><br><span class="hljs-string">Cipher update(string)   : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">Cipher update(hex)      : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a,b,c);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>().<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>();<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.doFinal()</span><br><span class="hljs-string">doFinal结果(string)     : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">doFinal结果(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.doFinal(byte[])</span><br><span class="hljs-string">doFinal参数(string)     : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">doFinal参数(hex)        : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">---</span><br><span class="hljs-string">doFinal结果(string)     : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">doFinal结果(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">Stack:</span><br><span class="hljs-string"><span class="hljs-subst">$&#123; Java.use(<span class="hljs-string">&quot;android.util.Log&quot;</span>).getStackTraceString(Java.use(<span class="hljs-string">&quot;java.lang.Exception&quot;</span>).$new()) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> x509EncodedKeySpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.security.spec.X509EncodedKeySpec&#x27;</span>);<br>    x509EncodedKeySpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.spec.X509EncodedKeySpec.$init(byte[])</span><br><span class="hljs-string">RSA密钥(string)         : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">RSA密钥(hex)            : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">RSA密钥(base64)         : <span class="hljs-subst">$&#123; bytesToBase64(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> rSAPublicKeySpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.security.spec.RSAPublicKeySpec&#x27;</span>);<br>    rSAPublicKeySpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.math.BigInteger&#x27;</span>,<span class="hljs-string">&#x27;java.math.BigInteger&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a,b);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.spec.RSAPublicKeySpec.$init(BigInteger, BigInteger)</span><br><span class="hljs-string">RSA密钥N                : <span class="hljs-subst">$&#123; a.toString(<span class="hljs-number">16</span>) &#125;</span></span><br><span class="hljs-string">RSA密钥E                : <span class="hljs-subst">$&#123; b.toString(<span class="hljs-number">16</span>) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure>        </div>      </div>    </div><p>上面是js的代码，方便起见可以用python辅助hook过程，不用每次都在命令行敲进程名，并且<code>send</code>函数发送的消息也需要python代码来接收（这个我没有深究，之前找到的教程是这么做的我就这么做了）</p><p>python代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">import</span> frida, sys<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br> <br>jsCode = <span class="hljs-literal">None</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> r:<br>    jsCode = r.read()  <span class="hljs-comment"># load js code</span><br>    <span class="hljs-comment"># print(jsCode)</span><br> <br>fw = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;log/&quot;</span> + datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d_%H_%M_%S&#x27;</span>) + sys.argv[<span class="hljs-number">1</span>].replace(<span class="hljs-string">&quot;.js&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;.\\&quot;</span>, <span class="hljs-string">&quot;&quot;</span>) + <span class="hljs-string">&quot;.log&quot;</span>,<span class="hljs-string">&#x27;w+&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)  <span class="hljs-comment"># file object to write log</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">message</span>(<span class="hljs-params">message, data</span>):<br>    <span class="hljs-keyword">if</span> message[<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&#x27;send&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">u&quot;[*] &#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(message[<span class="hljs-string">&#x27;payload&#x27;</span>]))<br>        fw.write(<span class="hljs-string">u&quot;[*] &#123;0&#125;\n&quot;</span>.<span class="hljs-built_in">format</span>(message[<span class="hljs-string">&#x27;payload&#x27;</span>]))<br>        fw.flush()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(message)<br><br><br>device = frida.get_usb_device()<br><span class="hljs-comment"># print(process)</span><br>pid = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> device.enumerate_applications():<br>    <span class="hljs-keyword">if</span> a.identifier == <span class="hljs-string">&quot;com.huawei.smarthome&quot;</span>:<br>        pid = a.pid  <span class="hljs-comment"># find the process by its&#x27; package name and get its&#x27; pid</span><br>        <span class="hljs-keyword">break</span><br>process = device.attach(pid)<br>script= process.create_script(jsCode)<br>script.on(<span class="hljs-string">&quot;message&quot;</span>, message)<br>script.load()<br>sys.stdin.read()<br></code></pre></td></tr></table></figure><p>hook之前需要先adb<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Android 调试桥 (adb)  | Android Studio  | Android Developers](https://developer.android.com/tools/adb?hl=zh-cn)">[7]</span></a></sup><sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[windows11安装adb步骤 - 测试0 - 博客园 (cnblogs.com)](https://www.cnblogs.com/momomolin/p/17347120.html)">[8]</span></a></sup>进入到设备的shell里然后启动frida-server</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">adb shell  # 先进入设备的shell<br><span class="hljs-function">oriole:/ $ <span class="hljs-title">su</span>  # 切换到<span class="hljs-title">root</span></span><br><span class="hljs-function"><span class="hljs-title">oriole</span>:/ # /<span class="hljs-title">data</span>/<span class="hljs-title">local</span>/<span class="hljs-title">tmp</span>/<span class="hljs-title">frida</span>-<span class="hljs-title">server</span>-16.1.10-<span class="hljs-title">android</span>-<span class="hljs-title">arm64</span> &amp;  # 加上&amp;，以后台方式运行<span class="hljs-title">frida</span>-<span class="hljs-title">server</span></span><br></code></pre></td></tr></table></figure><p>注意要有root权限，并且frida-server必须是对应的架构，和pc端的frida版本是否必须保持一致我没有确认，但是，if you can, why not。</p><p>然后手动启动应用，再启动python脚本文件开始hook就可以了</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">conda activate hook<br>python .\hook.py .\javaCipherAIO.js<br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/topjohnwu/Magisk">topjohnwu&#x2F;Magisk: The Magic Mask for Android (github.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/frida/frida">frida&#x2F;frida: Clone this repo to build Frida (github.com)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.cnblogs.com/Only-xiaoxiao/p/17294561.html">Frida 原理及简单使用 - Only-xiaoxiao - 博客园 (cnblogs.com)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://www.cnblogs.com/wutou/p/17884865.html">Frida server 和 python client下载 版本对应关系 - 悟透 - 博客园 (cnblogs.com)</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://github.com/skylot/jadx">skylot&#x2F;jadx: Dex to Java decompiler (github.com)</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://www.cnblogs.com/luoyesiqiu/p/10718997.html">frida的用法–Hook Java代码篇 - luoyesiqiu - 博客园 (cnblogs.com)</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://developer.android.com/tools/adb?hl=zh-cn">Android 调试桥 (adb)  | Android Studio  | Android Developers</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://www.cnblogs.com/momomolin/p/17347120.html">windows11安装adb步骤 - 测试0 - 博客园 (cnblogs.com)</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>android</tag>
      
      <tag>reverse</tag>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker容器不显示中文</title>
    <link href="/2024/03/14/docker%E5%AE%B9%E5%99%A8%E4%B8%8D%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87/"/>
    <url>/2024/03/14/docker%E5%AE%B9%E5%99%A8%E4%B8%8D%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87/</url>
    
    <content type="html"><![CDATA[<p>打算搬迁自己的笔记到组里的服务器上，又因为是服务器，对环境限制比较多，不会随便安装一些包和lib库，所以大家基本上都是docker开自己的容器用。</p><p>然后：</p><p><img src="https://s2.loli.net/2024/03/14/uPHk8FEq4SVAYpo.png" alt="image-20240314104511933"></p><p>终端无法显示中文，实际上<code>zsh</code>的命令补全还是能显示中文的，但是终端就是不行</p><p><img src="https://s2.loli.net/2024/03/14/JFkHUG1vmegfPhq.png" alt="image-20240314104637839"></p><p>按照找到的教程，<code>locale</code>和<code>locale -a</code>查看本地正在使用以及支持的字符集：</p><p><img src="https://s2.loli.net/2024/03/14/iHQOxWjlLrwX5hJ.png" alt="image-20240314104823601"></p><p>这里看到<code>LC_ALL=C</code>，按照某个教程里的说法，<code>C</code>就是<code>POSIX</code>，是不支持中文显示的，修改为<code>zh_CN.utf8</code>或者<code>C.utf8</code>就可以了，实测都是有效的，似乎是排序上有一些不同</p><p><img src="https://s2.loli.net/2024/03/14/pf57C2rPzFxSuB6.png" alt="image-20240314105152076"></p><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>关于各种<code>LC_*</code>变量以及<code>LANG</code>变量，看到的说法是<code>LC_ALL</code>是指定所有的字符集设置<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[LOCALE\]字符集设置 - Linux Guide (zj-linux-guide.readthedocs.io)](https://zj-linux-guide.readthedocs.io/zh-cn/latest/tool-install-configure/[LOCALE]字符集设置/)">[2]</span></a></sup>，看到很多教程上说让修改<code>LANG</code>变量，实际上试了一下是没用的</p><p>比如<code>LANG=C.utf8</code>且<code>LC_ALL=C</code>，可以看到还是显示不了中文：</p><p><img src="https://s2.loli.net/2024/03/14/KlYbREoxAsJItif.png" alt="image-20240314105437274"></p><p>包括把<code>LANG</code>设置为<code>zh_CN.utf8</code>也没有用：</p><p><img src="https://s2.loli.net/2024/03/14/xhdyP8tuzrWgfXA.png" alt="image-20240314105558850"></p><p>总的来说就是，只要<code>LC_ALL</code>是不支持中文字符的<code>C</code>，修改<code>LANG</code>就没有用，主要是<code>LC_ALL</code>变量的设置，因为设置了<code>LC_ALL</code>变量，其他的<code>LC_*</code>变量也都修改了，但是只设置<code>LANG</code>就会只修改<code>LANG</code>，如图修改<code>LC_ALL</code>：</p><p><img src="https://s2.loli.net/2024/03/14/zPKLpY5FTif9q2S.png" alt="image-20240314105921600"></p><p>and，很多教程里有的地方写的是<code>zh_CN.UTF-8</code>，有的是<code>zh_CN.utf-8</code>，测试了一下，设置<code>LC_ALL=zh_CN.UTF-8</code>也是有效的，但我觉得还是和<code>locale -a</code>的某一行输出（for example <code>zh_CN.utf8</code>）里保持一致可能会好一点，这一点可能需要去翻一翻文档去确认一下怎么设置最规范，但是我没有去翻</p><p>如果<code>locale -a</code>输出里没有自己需要的字符集，可以通过<code>dpkg-reconfigure locales</code>安装，如果显示没有<code>locales</code>，需要安装<code>locales</code><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[明眸如初 (zywvvd.com)](https://www.zywvvd.com/notes/system/linux/ubuntu-language-zh-cn/ubuntu-language-zh-cn/)">[1]</span></a></sup></p><h3 id="后后记"><a href="#后后记" class="headerlink" title="后后记"></a>后后记</h3><p>无语，忘记是什么时候的事，<code>.zshrc</code>里我自己添加了字符集的设置：</p><p><img src="https://s2.loli.net/2024/03/14/lBQZNAYcMexWpzU.png" alt="image-20240314111948828"></p><p>我就说为什么设置了<code>/etc/environment</code>没有用，总之，不管是<code>/etc/environment</code>还是<code>.zshrc</code>，能把<code>LC_ALL</code>变量设置成<code>zh_CN.utf8</code>而不是<code>C</code>就行</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.zywvvd.com/notes/system/linux/ubuntu-language-zh-cn/ubuntu-language-zh-cn/">明眸如初 (zywvvd.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zj-linux-guide.readthedocs.io/zh-cn/latest/tool-install-configure/[LOCALE]%E5%AD%97%E7%AC%A6%E9%9B%86%E8%AE%BE%E7%BD%AE/">LOCALE]字符集设置 - Linux Guide (zj-linux-guide.readthedocs.io)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span>（我讨厌CSDN，但是还是要放个引用在这里）<a href="https://blog.csdn.net/weixin_44455388/article/details/109092222">docker 容器中不支持中文的解决方法_docker locale-CSDN博客</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>沁园春-长沙</title>
    <link href="/2024/03/07/%E6%B2%81%E5%9B%AD%E6%98%A5-%E9%95%BF%E6%B2%99/"/>
    <url>/2024/03/07/%E6%B2%81%E5%9B%AD%E6%98%A5-%E9%95%BF%E6%B2%99/</url>
    
    <content type="html"><![CDATA[<p>（1925）毛泽东</p><hr><p>独立寒秋，湘江北去，橘子洲头。看万山红遍，层林尽染；漫江碧透，百舸争流。鹰击长空，鱼翔浅底，万类霜天竞自由。怅寥廓，问苍茫大地，谁主沉浮？</p><p>携来百侣曾游，忆往昔、峥嵘岁月稠。恰同学少年，风华正茂；书生意气，挥斥方遒。指点江山，激扬文字，粪土当年万户侯。曾记否，到中流击水，浪遏飞舟？</p><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://www.ziyexing.com/maozedong/shici/mzd_shici_02.htm">http://www.ziyexing.com/maozedong/shici/mzd_shici_02.htm</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>八六子-倚危亭</title>
    <link href="/2024/03/07/%E5%85%AB%E5%85%AD%E5%AD%90-%E5%80%9A%E5%8D%B1%E4%BA%AD/"/>
    <url>/2024/03/07/%E5%85%AB%E5%85%AD%E5%AD%90-%E5%80%9A%E5%8D%B1%E4%BA%AD/</url>
    
    <content type="html"><![CDATA[<p>（宋）秦观</p><hr><p>倚危亭，恨如芳草，</p><p>萋萋刬尽还生。</p><p>念柳外青骢别后，水边红袂分时，</p><p>怆然暗惊。</p><p>无端天与娉婷，夜月一帘幽梦，</p><p>春风十里柔情。</p><p>怎奈向、欢娱渐随流水，</p><p>素弦声断，翠绡香减，</p><p>那堪片片飞花弄晚，蒙蒙残雨笼晴。</p><p>正销凝，黄鹂又啼数声。</p><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://www.xinhuanet.com/politics/2017-03/02/c_129499433.htm">http://www.xinhuanet.com/politics/2017-03/02/c_129499433.htm</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>唐多令</title>
    <link href="/2024/03/07/%E5%94%90%E5%A4%9A%E4%BB%A4/"/>
    <url>/2024/03/07/%E5%94%90%E5%A4%9A%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<p>刘过</p><hr><p>安远楼小集，侑觞歌板之姬黄其姓者，乞词于龙洲道人，为赋此《唐多令》。同柳阜之、刘去非、石民瞻、周嘉仲、陈孟参、孟容。时八月五日也。</p><p>芦叶满汀洲，寒沙带浅流。二十年重过南楼。柳下系船犹未稳，能几日，又中秋。</p><p>黄鹤断矶头，故人曾到否？旧江山浑是新愁。欲买桂花同载酒，终不似，少年游</p><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://baike.baidu.com/item/%E5%94%90%E5%A4%9A%E4%BB%A4%C2%B7%E8%8A%A6%E5%8F%B6%E6%BB%A1%E6%B1%80%E6%B4%B2/8464037">唐多令·芦叶满汀洲_百度百科 (baidu.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>随笔</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
